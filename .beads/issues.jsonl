{"id":"simple-agent-harness-0t2","title":"Rate limit detection must only inspect system-level events, not tool output content","description":"The rate limit detection logic must not grep the entire JSONL output stream. When the agent reads source files that mention rate limiting (e.g., SPEC.md documenting the rate limit feature), naive pattern matching produces false positives and causes the loop to exit prematurely.\n\nFix applied in ralph-wiggums-loop.sh: check_rate_limited() now only inspects the final type=result event for is_error:true or subtype:error before checking for rate limit keywords.\n\nThe Rust harness (runner.rs / metrics.rs) needs the same approach:\n- Only check the session result metadata (exit code, error type) for rate limit signals\n- Never grep raw JSONL content that includes tool_result payloads\n- A successful session (is_error=false, subtype=success) should never be classified as rate limited regardless of output content","status":"closed","priority":3,"issue_type":"bug","owner":"shout@ozten.com","created_at":"2026-02-15T01:10:05.841494Z","created_by":"Austin King","updated_at":"2026-02-15T02:42:03.876926Z","closed_at":"2026-02-15T02:42:03.876926Z","close_reason":"Fix rate limit detection false positives: only inspect final result event"}
{"id":"simple-agent-harness-11h","title":"Implement brief command with improvement context output","description":"Implement 'blacksmith brief' CLI command that generates a performance feedback snippet for prompt injection. Queries open improvements from DB, formats them as markdown with ref, category, and title. Output format per PRD: '## OPEN IMPROVEMENTS (N of M)' section listing each open improvement. Returns empty string (no output) if no DB exists. PRD ref: Brief command output, Loop Integration \u003e Pre-session. Files: new src/brief.rs, src/main.rs (wire subcommand), src/db.rs (query helpers).","status":"closed","priority":1,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T13:27:18.281494Z","created_by":"Austin King","updated_at":"2026-02-15T13:58:02.293862Z","closed_at":"2026-02-15T13:58:02.293862Z","close_reason":"Implement brief command with improvement context output","dependencies":[{"issue_id":"simple-agent-harness-11h","depends_on_id":"simple-agent-harness-evl","type":"blocks","created_at":"2026-02-15T13:28:13.42321Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-2pg","title":"Integrate brief injection into session loop pre-session step","description":"Modify the prompt assembly step in runner.rs to auto-generate the brief and insert it between prepend_commands output and the prompt file content. Sequence: run prepend_commands, generate brief from blacksmith.db (built-in), read prompt file, assemble with separators. Brief is silently skipped when no database exists (first run). PRD ref: Loop Integration \u003e Pre-session: Brief Injection, Loop Lifecycle diagram step 2b. Files: src/runner.rs, src/prompt.rs (add brief injection step).","status":"closed","priority":1,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-15T13:27:19.840568Z","created_by":"Austin King","updated_at":"2026-02-15T14:00:59.876899Z","closed_at":"2026-02-15T14:00:59.876899Z","close_reason":"Integrate brief injection into session loop prompt assembly","dependencies":[{"issue_id":"simple-agent-harness-2pg","depends_on_id":"simple-agent-harness-11h","type":"blocks","created_at":"2026-02-15T13:28:15.084547Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-3dl","title":"Implement status file with atomic JSON writes","description":"Write harness.status as JSON on every state transition. Use atomic write pattern: write to temp file then rename. JSON fields: pid, state, iteration, max_iterations, global_iteration, output_file, output_bytes, session_start, last_update, last_completed_iteration, last_committed, consecutive_rate_limits. States: starting, pre_hooks, session_running, watchdog_kill, retrying, post_hooks, rate_limited_backoff, idle, shutting_down. Acceptance: status file is valid JSON after each state change, rename is atomic. See PRD: Status File section.","status":"closed","priority":2,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-14T23:48:24.730616Z","created_by":"Austin King","updated_at":"2026-02-15T01:14:02.979012Z","closed_at":"2026-02-15T01:14:02.979012Z","close_reason":"Implement status file with atomic JSON writes","dependencies":[{"issue_id":"simple-agent-harness-3dl","depends_on_id":"simple-agent-harness-p0y","type":"blocks","created_at":"2026-02-14T23:50:42.105114Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-5x6","title":"Implement --dry-run mode","description":"When --dry-run flag is passed: validate the resolved configuration (after merging CLI \u003e file \u003e defaults), print all resolved settings in a readable format, then exit without starting the loop. Useful for verifying config before long runs. Acceptance: --dry-run prints resolved config and exits 0 on valid config, exits non-zero with error on invalid config. See PRD: CLI Interface.","status":"open","priority":3,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-14T23:49:40.45134Z","created_by":"Austin King","updated_at":"2026-02-14T23:49:44.490018Z","dependencies":[{"issue_id":"simple-agent-harness-5x6","depends_on_id":"simple-agent-harness-utz","type":"blocks","created_at":"2026-02-14T23:50:55.542394Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-7d0","title":"Implement rate limit detection with exponential backoff","description":"Scan session output file for rate limit indicators: JSON 'error:rate_limit', text patterns 'usage limit', 'hit your limit', 'resets.*UTC' (case-insensitive). On detection: increment consecutive rate limit counter, apply exponential backoff (initial_delay * 2^consecutive_count, capped at max_delay_secs), do not increment productive iteration counter. After max_consecutive_rate_limits consecutive rate limits, exit the loop. A successful session resets counter and backoff. Acceptance: rate limit patterns detected correctly, backoff escalates, loop exits after max consecutive. See PRD: Rate Limit Detection section.","status":"closed","priority":3,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-14T23:49:19.661408Z","created_by":"Austin King","updated_at":"2026-02-15T01:58:33.907576Z","closed_at":"2026-02-15T01:58:33.907576Z","close_reason":"Implement rate limit detection with exponential backoff","dependencies":[{"issue_id":"simple-agent-harness-7d0","depends_on_id":"simple-agent-harness-p0y","type":"blocks","created_at":"2026-02-14T23:50:52.427094Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-7rx","title":"Implement signal handling and graceful shutdown","description":"Implement signals.rs: three shutdown triggers. (1) STOP file: checked at top of each iteration, if present log event, delete file, exit. (2) First SIGINT: set flag, finish current session, then exit loop. Print 'Caught SIGINT, finishing current session...'. (3) Second SIGINT within 3s: kill current agent process group immediately, exit. (4) SIGTERM: same as single SIGINT. On any shutdown: persist global iteration counter, write final status. Uses tokio::signal for async signal handling. Acceptance: integration test showing STOP file triggers clean exit. See PRD: Graceful Shutdown section.","status":"closed","priority":1,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-14T23:48:48.437997Z","created_by":"Austin King","updated_at":"2026-02-15T00:17:24.372894Z","closed_at":"2026-02-15T00:17:24.372894Z","close_reason":"Closed","dependencies":[{"issue_id":"simple-agent-harness-7rx","depends_on_id":"simple-agent-harness-utz","type":"blocks","created_at":"2026-02-14T23:50:32.687071Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-8ff","title":"Implement pre/post-session hook execution","description":"Implement hooks.rs: execute shell commands from config [hooks] pre_session and post_session arrays. Run synchronously before/after each session. Set environment variables: HARNESS_ITERATION, HARNESS_GLOBAL_ITERATION, HARNESS_PROMPT_FILE (pre+post), plus HARNESS_OUTPUT_FILE, HARNESS_EXIT_CODE, HARNESS_OUTPUT_BYTES, HARNESS_SESSION_DURATION, HARNESS_COMMITTED (post only). Pre-session hook failure (non-zero exit) skips the iteration with logged error. Post-session hook failure logs error but continues. Empty retries do NOT trigger post-session hooks. Acceptance: hooks run with correct env vars, failures handled per spec. See PRD: Hooks section.","status":"closed","priority":2,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-14T23:48:49.867764Z","created_by":"Austin King","updated_at":"2026-02-15T01:34:28.791281Z","closed_at":"2026-02-15T01:34:28.791281Z","close_reason":"Implement pre/post-session hook execution with env vars","dependencies":[{"issue_id":"simple-agent-harness-8ff","depends_on_id":"simple-agent-harness-p0y","type":"blocks","created_at":"2026-02-14T23:50:47.74734Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-8j5","title":"Implement built-in JSONL metric extraction for turns, cost, and duration","description":"Implement a JSONL parser that reads Claude session output files and extracts built-in metrics: turns.total (count of assistant events), turns.narration_only (assistant events with text but no tool_use), turns.parallel (assistant events with 2+ tool_use blocks), turns.tool_calls (total tool_use blocks), cost.input_tokens/output_tokens/estimate_usd (from usage data), session.output_bytes (file size), session.exit_code. Write extracted metrics as events to the events table. Update observations table. PRD ref: Built-in Metrics, Event Kinds. Files: new src/ingest.rs, src/db.rs (event insert helpers).","status":"closed","priority":1,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T13:27:30.612248Z","created_by":"Austin King","updated_at":"2026-02-15T14:07:06.778686Z","closed_at":"2026-02-15T14:07:06.778686Z","close_reason":"Implement built-in JSONL metric extraction for turns, cost, and duration","dependencies":[{"issue_id":"simple-agent-harness-8j5","depends_on_id":"simple-agent-harness-cl6","type":"blocks","created_at":"2026-02-15T13:28:17.903237Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-9cm","title":"Implement metrics rebuild command to regenerate observations from events","description":"Implement 'blacksmith metrics rebuild' command that drops and recreates the observations table from events. Useful after manual event edits or migration. PRD ref: Observations Table \u003e Rebuild command. Files: src/metrics_cmd.rs, src/db.rs (rebuild_observations function).","status":"open","priority":3,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-15T13:27:43.027635Z","created_by":"Austin King","updated_at":"2026-02-15T13:30:23.790913Z","dependencies":[{"issue_id":"simple-agent-harness-9cm","depends_on_id":"simple-agent-harness-cl6","type":"blocks","created_at":"2026-02-15T13:28:34.799168Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-cl6","title":"Create events and observations tables in database module","description":"Add events table (id, ts, session, kind, value, tags) and observations table (session PK, ts, duration, outcome, data JSON) to the database module. Create indexes on events(session), events(kind), events(ts). Observations is a materialized per-session summary. Add insert/query functions for both tables. PRD ref: Storage Model \u003e Events Table, Observations Table. Files: src/db.rs.","status":"closed","priority":1,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-15T13:27:28.971673Z","created_by":"Austin King","updated_at":"2026-02-15T14:03:25.154817Z","closed_at":"2026-02-15T14:03:25.154817Z","close_reason":"Add events and observations tables with insert/query functions and indexes","dependencies":[{"issue_id":"simple-agent-harness-cl6","depends_on_id":"simple-agent-harness-sxy","type":"blocks","created_at":"2026-02-15T13:28:16.337262Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-d3v","title":"Implement session spawning and output capture","description":"Implement session.rs: spawn the agent subprocess using tokio::process::Command. Construct the command from config [agent] section, replacing {prompt} placeholder with actual prompt content. Pipe stdout and stderr to a JSONL output file named {output_prefix}-{global_iteration}.jsonl. Track the child PID and process group for later cleanup. Provide an async function that returns SessionResult with exit_code, output_bytes, duration. Acceptance: can spawn a simple command (e.g. echo), capture its output to a file, and report correct exit code and byte count. See PRD: Session Lifecycle, Architecture.","status":"closed","priority":1,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-14T23:48:19.006921Z","created_by":"Austin King","updated_at":"2026-02-15T00:06:54.404814Z","closed_at":"2026-02-15T00:06:54.404814Z","close_reason":"Closed","dependencies":[{"issue_id":"simple-agent-harness-d3v","depends_on_id":"simple-agent-harness-utz","type":"blocks","created_at":"2026-02-14T23:50:28.653853Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-edb","title":"Implement config validation with helpful error messages","description":"Add thorough validation to config loading: check that prompt_file exists, output_dir exists or can be created, command binary is in PATH, timeout values are positive, retry counts are non-negative, etc. Produce clear error messages indicating which field is invalid and what values are acceptable. Validate on load so errors surface immediately, not mid-run. Acceptance: invalid config produces clear, actionable error messages. See PRD: Configuration section.","status":"open","priority":3,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-14T23:49:57.481176Z","created_by":"Austin King","updated_at":"2026-02-14T23:50:02.569419Z","dependencies":[{"issue_id":"simple-agent-harness-edb","depends_on_id":"simple-agent-harness-utz","type":"blocks","created_at":"2026-02-14T23:50:58.073222Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-ee7","title":"Implement commit detection in session output","description":"Scan session output for commit indicators (bd-finish, git commit success patterns). Set 'committed' field in status file and event log. Used by --status command to show 'committed (bd-finish detected)' for last completed iteration. Patterns should be configurable. Acceptance: committed=true when output contains commit indicators. See PRD: Status File, Event Log sections.","status":"closed","priority":3,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-14T23:49:32.16106Z","created_by":"Austin King","updated_at":"2026-02-15T04:53:28.723337Z","closed_at":"2026-02-15T04:53:28.723337Z","close_reason":"Implement commit detection in session output","dependencies":[{"issue_id":"simple-agent-harness-ee7","depends_on_id":"simple-agent-harness-p0y","type":"blocks","created_at":"2026-02-14T23:50:54.258018Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-evl","title":"Implement improve add and improve list CLI subcommands","description":"Add clap subcommand structure: blacksmith improve add/list. The 'add' command takes title (positional), --category (required), --body, --context, --tags. Auto-assigns next ref (R1, R2, ...). The 'list' command supports --status and --category filters, displays in table format. Wire subcommands into main.rs CLI. PRD ref: CLI Interface \u003e Improvement commands. Files: src/main.rs (CLI struct), src/db.rs (insert/query), new src/improve.rs (command handlers).","status":"closed","priority":1,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T13:27:15.855783Z","created_by":"Austin King","updated_at":"2026-02-15T13:55:59.763899Z","closed_at":"2026-02-15T13:55:59.763899Z","close_reason":"Implement improve add and improve list CLI subcommands","dependencies":[{"issue_id":"simple-agent-harness-evl","depends_on_id":"simple-agent-harness-sxy","type":"blocks","created_at":"2026-02-15T13:28:08.070976Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-ewc","title":"Scaffold Rust project with Cargo.toml and module stubs","description":"Set up the Rust project skeleton. Create Cargo.toml with all dependencies (clap, serde, toml, tokio, nix, chrono, serde_json, tracing, tracing-subscriber). Create src/ with stub files: main.rs, config.rs, runner.rs, session.rs, watchdog.rs, retry.rs, metrics.rs, signals.rs, hooks.rs. main.rs should have a minimal clap CLI that compiles and prints help. Include a default harness.toml with all config sections from the PRD. Acceptance: 'cargo build' succeeds, 'cargo run -- --help' prints usage.","status":"closed","priority":0,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-14T23:47:23.476559Z","created_by":"Austin King","updated_at":"2026-02-15T00:00:09.247912Z","closed_at":"2026-02-15T00:00:09.247912Z","close_reason":"Scaffold complete: cargo build succeeds, cargo run -- --help prints usage"}
{"id":"simple-agent-harness-fgf","title":"Implement --status CLI command","description":"When --status flag is passed, read harness.status JSON file and display formatted output: loop state, current iteration/max, global iteration, session output size and growth status, uptime, last completed iteration info. Print and exit (do not start the loop). Handle missing status file gracefully with 'No running harness detected'. See PRD: Status Command section.","status":"closed","priority":2,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-14T23:48:33.108264Z","created_by":"Austin King","updated_at":"2026-02-15T01:17:31.758447Z","closed_at":"2026-02-15T01:17:31.758447Z","close_reason":"Implement --status CLI command with formatted status display","dependencies":[{"issue_id":"simple-agent-harness-fgf","depends_on_id":"simple-agent-harness-3dl","type":"blocks","created_at":"2026-02-14T23:50:43.334863Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-fvr","title":"Implement watchdog output-growth monitor","description":"Implement watchdog.rs: a tokio task that monitors the output file for growth. Algorithm: record initial size, check every check_interval_secs, reset stale timer on growth, kill process group after stale_timeout_mins of no growth. Process cleanup: SIGTERM to process group, wait 5s, SIGKILL if still alive, collect exit status. Return exit code 124 on timeout kill. Uses nix crate for signal/process group management. Acceptance: unit test with a mock slow-writing process that gets killed after stale timeout. See PRD: Watchdog section.","status":"closed","priority":1,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-14T23:48:29.04948Z","created_by":"Austin King","updated_at":"2026-02-15T00:10:59.0807Z","closed_at":"2026-02-15T00:10:59.0807Z","close_reason":"Closed","dependencies":[{"issue_id":"simple-agent-harness-fvr","depends_on_id":"simple-agent-harness-d3v","type":"blocks","created_at":"2026-02-14T23:50:29.92715Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-h97","title":"Add target miss warnings and streak detection to brief output","description":"Extend brief output to auto-generate warnings when targets are missed. Include streak detection: escalate warnings after N consecutive misses (configurable). Format per PRD brief example. PRD ref: Milestone 3 bullet points. Files: src/brief.rs, src/config.rs (streak config).","status":"open","priority":2,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T13:27:40.106578Z","created_by":"Austin King","updated_at":"2026-02-15T13:30:15.050738Z","dependencies":[{"issue_id":"simple-agent-harness-h97","depends_on_id":"simple-agent-harness-pcb","type":"blocks","created_at":"2026-02-15T13:28:30.759438Z","created_by":"Austin King"},{"issue_id":"simple-agent-harness-h97","depends_on_id":"simple-agent-harness-obm","type":"blocks","created_at":"2026-02-15T13:28:32.155079Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-i9s","title":"Implement configurable extraction rules from TOML config","description":"Parse [metrics.extract.rules] from blacksmith.toml config. Each rule has: kind, pattern (regex), optional anti_pattern, source (tool_commands/text/raw), transform (last_segment/int/trim), first_match, count, emit. Apply rules during JSONL ingestion alongside built-in metrics. Adding a new metric = 3-4 lines of TOML. PRD ref: Configurable Extraction Rules. Files: src/config.rs (new MetricsExtractConfig), src/ingest.rs (apply rules during parse).","status":"closed","priority":2,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T13:27:37.285841Z","created_by":"Austin King","updated_at":"2026-02-15T14:24:50.388679Z","closed_at":"2026-02-15T14:24:50.388679Z","close_reason":"Implement configurable extraction rules from TOML config","dependencies":[{"issue_id":"simple-agent-harness-i9s","depends_on_id":"simple-agent-harness-8j5","type":"blocks","created_at":"2026-02-15T13:28:28.08633Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-j1w","title":"Implement metrics migrate command for V1 data import","description":"Implement 'blacksmith metrics migrate --from \u003cpath\u003e' to import V1 self-improvement.db data. Map V1 sessions table columns to V2 event kinds per PRD mapping (assistant_turns -\u003e turns.total, etc). Copy improvements rows mapping severity -\u003e category. Rebuild observations after import. PRD ref: Migration from V1. Files: src/metrics_cmd.rs (migrate command), src/db.rs (V1 schema read).","status":"open","priority":3,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T13:27:41.86492Z","created_by":"Austin King","updated_at":"2026-02-15T13:30:19.610122Z","dependencies":[{"issue_id":"simple-agent-harness-j1w","depends_on_id":"simple-agent-harness-cl6","type":"blocks","created_at":"2026-02-15T13:28:33.384002Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-jr7","title":"Implement retry policy for empty sessions","description":"Implement retry.rs: detect when session output is below min_output_bytes threshold. On empty session: log warning with output size, increment global_iteration (new output filename), re-run session with same prompt, after max_empty_retries failures skip to next iteration. Empty retries do NOT increment productive iteration counter and do NOT trigger post-session hooks. Acceptance: unit test showing retry behavior with configurable thresholds. See PRD: Retry Policy section.","status":"closed","priority":1,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-14T23:48:38.6347Z","created_by":"Austin King","updated_at":"2026-02-15T00:13:47.076532Z","closed_at":"2026-02-15T00:13:47.076532Z","close_reason":"Closed","dependencies":[{"issue_id":"simple-agent-harness-jr7","depends_on_id":"simple-agent-harness-d3v","type":"blocks","created_at":"2026-02-14T23:50:31.225368Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-k53","title":"Integrate automatic post-session JSONL ingestion into loop","description":"Wire automatic JSONL ingestion into the session loop in runner.rs. After each session completes and passes retry evaluation (step 6 in lifecycle), call the ingest module to parse the session output file and write events to blacksmith.db. Pass session number and duration from the harness. Only runs when metrics DB exists. PRD ref: Loop Integration \u003e Post-session: Automatic Ingestion, Loop Lifecycle step 6. Files: src/runner.rs.","status":"closed","priority":1,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-15T13:27:31.893918Z","created_by":"Austin King","updated_at":"2026-02-15T14:10:12.993409Z","closed_at":"2026-02-15T14:10:12.993409Z","close_reason":"Wire automatic JSONL ingestion into runner loop","dependencies":[{"issue_id":"simple-agent-harness-k53","depends_on_id":"simple-agent-harness-8j5","type":"blocks","created_at":"2026-02-15T13:28:19.137505Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-mxg","title":"Implement prompt prepend_commands for dynamic prompt construction","description":"Support [prompt] config section with file and prepend_commands fields. Read prompt from file, run each prepend command and capture stdout, prepend non-empty outputs to prompt separated by newline-dash-newline. Empty command output is silently skipped. This replaces inline bash logic for injecting performance briefs. Acceptance: prompt is correctly assembled with prepended command outputs. See PRD: Prompt Injection section.","status":"closed","priority":2,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-14T23:49:10.212331Z","created_by":"Austin King","updated_at":"2026-02-15T01:53:18.846511Z","closed_at":"2026-02-15T01:53:18.846511Z","close_reason":"Implement prompt prepend_commands for dynamic prompt construction","dependencies":[{"issue_id":"simple-agent-harness-mxg","depends_on_id":"simple-agent-harness-utz","type":"blocks","created_at":"2026-02-14T23:50:49.043389Z","created_by":"Austin King"},{"issue_id":"simple-agent-harness-mxg","depends_on_id":"simple-agent-harness-d3v","type":"blocks","created_at":"2026-02-14T23:50:50.339371Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-obm","title":"Implement configurable target thresholds and metrics targets command","description":"Parse [metrics.targets.rules] from blacksmith.toml config. Each rule: kind, compare (pct_of/pct_sessions/avg), relative_to, threshold, direction (above/below), label, unit. Implement 'blacksmith metrics targets' command showing configured targets vs recent performance. PRD ref: Targets and Thresholds, CLI \u003e metrics targets. Files: src/config.rs (new MetricsTargetsConfig), src/metrics_cmd.rs (targets command), src/db.rs (aggregation queries).","status":"open","priority":2,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T13:27:38.696566Z","created_by":"Austin King","updated_at":"2026-02-15T13:30:10.883374Z","dependencies":[{"issue_id":"simple-agent-harness-obm","depends_on_id":"simple-agent-harness-cl6","type":"blocks","created_at":"2026-02-15T13:28:29.313453Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-odo","title":"Implement metrics export, query, and events dump commands","description":"Implement three CLI commands: 'blacksmith metrics export [--format csv|json]' to export all observations, 'blacksmith metrics query \u003ckind\u003e [--last N] [--aggregate avg|trend]' for ad-hoc metric queries, and 'blacksmith metrics events [--session N]' to dump raw events. PRD ref: CLI Interface \u003e Metrics commands. Files: src/metrics_cmd.rs, src/db.rs.","status":"open","priority":3,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T13:27:44.509093Z","created_by":"Austin King","updated_at":"2026-02-15T13:30:29.207092Z","dependencies":[{"issue_id":"simple-agent-harness-odo","depends_on_id":"simple-agent-harness-cl6","type":"blocks","created_at":"2026-02-15T13:28:36.094019Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-p0y","title":"Implement main runner loop orchestration","description":"Implement runner.rs: the core loop that ties all modules together. For each iteration: (1) check STOP file, (2) read and prepare prompt from prompt_file, (3) spawn agent session, (4) start watchdog alongside session, (5) on completion check output size and retry if needed, (6) update iteration counters (productive + global), (7) apply inter-iteration delay. Track productive iterations vs max_iterations. The runner owns the iteration state and delegates to session, watchdog, retry, and signals modules. Acceptance: can run N productive iterations with a mock agent command (e.g. 'echo hello'), handles empty sessions with retries, stops on max_iterations. See PRD: Core Behavior, Session Lifecycle.","status":"closed","priority":0,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-14T23:48:58.908464Z","created_by":"Austin King","updated_at":"2026-02-15T00:22:58.535681Z","closed_at":"2026-02-15T00:22:58.535681Z","close_reason":"Closed","dependencies":[{"issue_id":"simple-agent-harness-p0y","depends_on_id":"simple-agent-harness-utz","type":"blocks","created_at":"2026-02-14T23:50:34.058289Z","created_by":"Austin King"},{"issue_id":"simple-agent-harness-p0y","depends_on_id":"simple-agent-harness-d3v","type":"blocks","created_at":"2026-02-14T23:50:35.313584Z","created_by":"Austin King"},{"issue_id":"simple-agent-harness-p0y","depends_on_id":"simple-agent-harness-fvr","type":"blocks","created_at":"2026-02-14T23:50:36.835817Z","created_by":"Austin King"},{"issue_id":"simple-agent-harness-p0y","depends_on_id":"simple-agent-harness-jr7","type":"blocks","created_at":"2026-02-14T23:50:39.029115Z","created_by":"Austin King"},{"issue_id":"simple-agent-harness-p0y","depends_on_id":"simple-agent-harness-7rx","type":"blocks","created_at":"2026-02-14T23:50:40.930624Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-pcb","title":"Add quantitative metrics summary to brief command output","description":"Extend the brief command to include quantitative metrics alongside improvements. Add a '## PERFORMANCE FEEDBACK' section showing last session metrics vs targets (if configured). Format: metric name, current value, target, OK/MISS status. PRD ref: Brief command output example, Loop Integration \u003e Pre-session. Files: src/brief.rs, src/db.rs (recent session query).","status":"closed","priority":2,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T13:27:35.646752Z","created_by":"Austin King","updated_at":"2026-02-15T14:18:39.832457Z","closed_at":"2026-02-15T14:18:39.832457Z","close_reason":"Add quantitative metrics summary to brief command output","dependencies":[{"issue_id":"simple-agent-harness-pcb","depends_on_id":"simple-agent-harness-11h","type":"blocks","created_at":"2026-02-15T13:28:24.801522Z","created_by":"Austin King"},{"issue_id":"simple-agent-harness-pcb","depends_on_id":"simple-agent-harness-pr9","type":"blocks","created_at":"2026-02-15T13:28:26.190926Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-pr9","title":"Implement metrics log and metrics status CLI commands","description":"Implement two CLI commands: 'blacksmith metrics log \u003cfile\u003e' for manual JSONL ingestion (calls the same ingest module), and 'blacksmith metrics status [--last N]' which displays a dashboard showing recent sessions from the observations table with key metrics, trends, and target status. Default --last is 10. PRD ref: CLI Interface \u003e Metrics commands. Files: src/main.rs (wire subcommands), new src/metrics_cmd.rs (command handlers), src/db.rs (query helpers).","status":"closed","priority":1,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T13:27:34.088296Z","created_by":"Austin King","updated_at":"2026-02-15T14:12:39.210778Z","closed_at":"2026-02-15T14:12:39.210778Z","close_reason":"Implement metrics log and metrics status CLI commands","dependencies":[{"issue_id":"simple-agent-harness-pr9","depends_on_id":"simple-agent-harness-cl6","type":"blocks","created_at":"2026-02-15T13:28:20.950162Z","created_by":"Austin King"},{"issue_id":"simple-agent-harness-pr9","depends_on_id":"simple-agent-harness-8j5","type":"blocks","created_at":"2026-02-15T13:28:23.512832Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-r43","title":"Implement --quiet mode for minimal output","description":"When --quiet flag is passed, suppress per-iteration banners and info-level messages. Only show errors and the final summary line. Integrate with tracing subscriber to filter log levels based on quiet/verbose flags: --quiet = error only, default = info, --verbose = debug + agent output interleaving. Acceptance: --quiet suppresses info logs, --verbose shows debug. See PRD: CLI Interface.","status":"open","priority":3,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-14T23:49:48.921881Z","created_by":"Austin King","updated_at":"2026-02-14T23:49:53.378028Z","dependencies":[{"issue_id":"simple-agent-harness-r43","depends_on_id":"simple-agent-harness-yyb","type":"blocks","created_at":"2026-02-14T23:50:56.849881Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-sxy","title":"Add SQLite dependency and create database module with improvements table","description":"Add rusqlite dependency to Cargo.toml. Create src/db.rs module with: open_or_create(path) function that opens/creates blacksmith.db in the output directory. Improvements table schema per PRD (id, ref, created, resolved, category, status, title, body, context, tags, meta). Indexes on status and category. Auto-increment ref assignment (R1, R2, ...). No CHECK constraints - validation is in CLI layer. PRD ref: Storage Model \u003e Improvements Table. Files: Cargo.toml, src/db.rs, src/main.rs (add mod db).","status":"closed","priority":1,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-15T13:27:14.461903Z","created_by":"Austin King","updated_at":"2026-02-15T13:52:03.300396Z","closed_at":"2026-02-15T13:52:03.300396Z","close_reason":"Add SQLite dependency and create database module with improvements table","dependencies":[{"issue_id":"simple-agent-harness-sxy","depends_on_id":"simple-agent-harness-ynf","type":"blocks","created_at":"2026-02-15T13:28:06.77572Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-t0t","title":"Implement JSONL event log for external tooling","description":"Optionally write harness-events.jsonl (configured via [output] event_log). Append one JSON line per significant state transition: session_complete events with fields ts, event, iteration, global, output_bytes, exit_code, duration_secs, committed, retries, rate_limited. File is append-only, one line per session. Designed for self-improvement tool ingestion. Acceptance: after N iterations, event log has N entries, each valid JSON. See PRD: Event Log section.","status":"closed","priority":2,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-14T23:48:48.41639Z","created_by":"Austin King","updated_at":"2026-02-15T01:25:32.653407Z","closed_at":"2026-02-15T01:25:32.653407Z","close_reason":"Implement JSONL event log for external tooling","dependencies":[{"issue_id":"simple-agent-harness-t0t","depends_on_id":"simple-agent-harness-p0y","type":"blocks","created_at":"2026-02-14T23:50:46.393057Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-utz","title":"Implement configuration loading and CLI argument parsing","description":"Implement config.rs and CLI parsing in main.rs. Config struct with serde derives, all fields from PRD [session], [agent], [watchdog], [retry], [backoff], [shutdown] sections. Load from harness.toml with compiled defaults for every field (so an empty file is valid). CLI flags via clap derive: --config, --prompt, --output-dir, --timeout, --retries, --dry-run, -v, -q, --status, plus positional MAX_ITERATIONS. Implement precedence: CLI flags \u003e harness.toml \u003e defaults. Acceptance: unit tests for default config, TOML loading, and CLI override merging. See PRD sections: Configuration, CLI Interface.","status":"closed","priority":1,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-14T23:48:09.799333Z","created_by":"Austin King","updated_at":"2026-02-15T00:03:47.416239Z","closed_at":"2026-02-15T00:03:47.416239Z","close_reason":"Implement config loading, CLI override merging, and unit tests","dependencies":[{"issue_id":"simple-agent-harness-utz","depends_on_id":"simple-agent-harness-ewc","type":"blocks","created_at":"2026-02-14T23:50:27.460281Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-v25","title":"Implement improve show/update/promote/dismiss/search commands","description":"Add remaining improve subcommands: show (display single improvement by ref with all fields), update (modify status/body/context by ref), promote (shorthand for --status=promoted with timestamp), dismiss (shorthand for --status=dismissed with --reason stored in meta JSON), search (full-text search across title, body, context fields). PRD ref: CLI Interface \u003e Improvement commands. Files: src/improve.rs, src/db.rs.","status":"closed","priority":2,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T13:27:17.054147Z","created_by":"Austin King","updated_at":"2026-02-15T14:15:41.45028Z","closed_at":"2026-02-15T14:15:41.45028Z","close_reason":"Implement improve show/update/promote/dismiss/search commands","dependencies":[{"issue_id":"simple-agent-harness-v25","depends_on_id":"simple-agent-harness-evl","type":"blocks","created_at":"2026-02-15T13:28:10.829801Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-ynf","title":"Rename package and binary from simple-agent-harness to blacksmith","description":"Rename the entire project from simple-agent-harness to blacksmith. Changes: Cargo.toml package name and binary name. CLI struct in main.rs (command name, version string, help text). Config file loading in config.rs: try blacksmith.toml first, fall back to harness.toml for backwards compat. Status file: blacksmith.status instead of harness.status (status.rs, runner.rs). All log messages and tracing output referencing the old name. Update dry-run output in main.rs. PRD ref: Milestone 0. Files: Cargo.toml, src/main.rs, src/config.rs, src/status.rs, src/runner.rs.","status":"closed","priority":1,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-15T13:27:11.61603Z","created_by":"Austin King","updated_at":"2026-02-15T13:49:42.874459Z","closed_at":"2026-02-15T13:49:42.874459Z","close_reason":"Rename package and binary from simple-agent-harness to blacksmith"}
{"id":"simple-agent-harness-yyb","title":"Implement structured console logging with tracing","description":"Set up tracing and tracing-subscriber for structured log output. Format: [timestamp] [LEVEL] key=value pairs. Keys include: iteration, global, status, pid, watchdog, stale_secs, limit, retry, output_bytes, committed. Agent subprocess output goes to JSONL file only, not console (unless --verbose). Replace any println! calls with tracing macros. Acceptance: log output matches PRD format examples. See PRD: Console Output section.","status":"closed","priority":2,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-14T23:48:39.755099Z","created_by":"Austin King","updated_at":"2026-02-15T01:20:12.417214Z","closed_at":"2026-02-15T01:20:12.417214Z","close_reason":"Implement structured console logging with tracing","dependencies":[{"issue_id":"simple-agent-harness-yyb","depends_on_id":"simple-agent-harness-utz","type":"blocks","created_at":"2026-02-14T23:50:45.148718Z","created_by":"Austin King"}]}
