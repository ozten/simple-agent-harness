{"id":"simple-agent-harness-0lk","title":"Add file resolution data model and cache","description":"Define FileResolution struct with task_id, base_commit, intent_hash, and mappings (concept -\u003e resolved_files + resolved_modules). Include derived fields: affected_modules, blast_radius (transitive dependents), boundary_signatures. Add DB table and caching layer keyed by commit hash — invalidates every time main advances. Ref: PRD section 'Layer 2: File Resolution'. New additions to src/intent.rs or new src/file_resolution.rs.","status":"closed","priority":1,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T20:11:34.340919Z","created_by":"Austin King","updated_at":"2026-02-15T21:50:15.624962Z","closed_at":"2026-02-15T21:50:15.624962Z","close_reason":"Add file resolution data model and cache"}
{"id":"simple-agent-harness-0t2","title":"Rate limit detection must only inspect system-level events, not tool output content","description":"The rate limit detection logic must not grep the entire JSONL output stream. When the agent reads source files that mention rate limiting (e.g., SPEC.md documenting the rate limit feature), naive pattern matching produces false positives and causes the loop to exit prematurely.\n\nFix applied in ralph-wiggums-loop.sh: check_rate_limited() now only inspects the final type=result event for is_error:true or subtype:error before checking for rate limit keywords.\n\nThe Rust harness (runner.rs / metrics.rs) needs the same approach:\n- Only check the session result metadata (exit code, error type) for rate limit signals\n- Never grep raw JSONL content that includes tool_result payloads\n- A successful session (is_error=false, subtype=success) should never be classified as rate limited regardless of output content","status":"closed","priority":3,"issue_type":"bug","owner":"shout@ozten.com","created_at":"2026-02-15T01:10:05.841494Z","created_by":"Austin King","updated_at":"2026-02-15T02:42:03.876926Z","closed_at":"2026-02-15T02:42:03.876926Z","close_reason":"Fix rate limit detection false positives: only inspect final result event"}
{"id":"simple-agent-harness-11h","title":"Implement brief command with improvement context output","description":"Implement 'blacksmith brief' CLI command that generates a performance feedback snippet for prompt injection. Queries open improvements from DB, formats them as markdown with ref, category, and title. Output format per PRD: '## OPEN IMPROVEMENTS (N of M)' section listing each open improvement. Returns empty string (no output) if no DB exists. PRD ref: Brief command output, Loop Integration \u003e Pre-session. Files: new src/brief.rs, src/main.rs (wire subcommand), src/db.rs (query helpers).","status":"closed","priority":1,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T13:27:18.281494Z","created_by":"Austin King","updated_at":"2026-02-15T13:58:02.293862Z","closed_at":"2026-02-15T13:58:02.293862Z","close_reason":"Implement brief command with improvement context output","dependencies":[{"issue_id":"simple-agent-harness-11h","depends_on_id":"simple-agent-harness-evl","type":"blocks","created_at":"2026-02-15T13:28:13.42321Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-1jv","title":"Implement git worktree lifecycle management","description":"Implement worktree creation from main: git worktree add .blacksmith/worktrees/worker-{N}-{bead-id} main. Implement worktree cleanup after successful integration. Track worktree paths in worker_assignments table. Handle edge cases: worktree already exists, main branch not available, cleanup of orphaned worktrees. Reference: SPEC-v3-agents.md lines 486-489, 547-549. Key files: src/coordinator.rs.","status":"closed","priority":1,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T14:54:39.978828Z","created_by":"Austin King","updated_at":"2026-02-15T15:44:41.202495Z","closed_at":"2026-02-15T15:44:41.202495Z","close_reason":"Implement git worktree lifecycle management","dependencies":[{"issue_id":"simple-agent-harness-1jv","depends_on_id":"simple-agent-harness-ib1","type":"blocks","created_at":"2026-02-15T14:56:56.450358Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-1ky","title":"Implement scheduler for assigning beads to idle workers","description":"Implement scheduler that runs when a worker becomes idle. Query beads for ready work (open status, all deps closed). Filter by affected set overlap with in-progress tasks. Assign highest-priority non-conflicting task. On assignment: update bead to in_progress, create worktree, spawn worker. The next_assignable_tasks function returns tasks whose affected sets don't overlap with any in-progress task. Reference: SPEC-v3-agents.md lines 462-489. Key files: src/coordinator.rs, src/scheduler.rs.","status":"closed","priority":1,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T14:55:00.844096Z","created_by":"Austin King","updated_at":"2026-02-15T15:55:12.163479Z","closed_at":"2026-02-15T15:55:12.163479Z","close_reason":"Implement scheduler for assigning beads to idle workers","dependencies":[{"issue_id":"simple-agent-harness-1ky","depends_on_id":"simple-agent-harness-mjx","type":"blocks","created_at":"2026-02-15T14:57:00.543096Z","created_by":"Austin King"},{"issue_id":"simple-agent-harness-1ky","depends_on_id":"simple-agent-harness-f9m","type":"blocks","created_at":"2026-02-15T14:57:01.849643Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-1u6","title":"Migrate file path construction to use storage.data_dir","description":"Replace all hardcoded path construction (output_dir, counter_file, output_prefix, status file) to use the new DataDir struct from .blacksmith/. Session output files become .blacksmith/sessions/{N}.jsonl. Counter becomes .blacksmith/counter. Status becomes .blacksmith/status. DB becomes .blacksmith/blacksmith.db. Deprecate session.output_prefix and session.counter_file config keys with warnings. Reference: SPEC-v3-agents.md lines 56-76. Key files: src/config.rs, src/runner.rs, src/session.rs, src/status.rs, src/db.rs.","status":"closed","priority":1,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-15T14:53:25.324065Z","created_by":"Austin King","updated_at":"2026-02-15T15:07:26.11886Z","closed_at":"2026-02-15T15:07:26.11886Z","close_reason":"Migrate file path construction to use storage.data_dir","dependencies":[{"issue_id":"simple-agent-harness-1u6","depends_on_id":"simple-agent-harness-ib1","type":"blocks","created_at":"2026-02-15T14:56:41.175394Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-2pg","title":"Integrate brief injection into session loop pre-session step","description":"Modify the prompt assembly step in runner.rs to auto-generate the brief and insert it between prepend_commands output and the prompt file content. Sequence: run prepend_commands, generate brief from blacksmith.db (built-in), read prompt file, assemble with separators. Brief is silently skipped when no database exists (first run). PRD ref: Loop Integration \u003e Pre-session: Brief Injection, Loop Lifecycle diagram step 2b. Files: src/runner.rs, src/prompt.rs (add brief injection step).","status":"closed","priority":1,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-15T13:27:19.840568Z","created_by":"Austin King","updated_at":"2026-02-15T14:00:59.876899Z","closed_at":"2026-02-15T14:00:59.876899Z","close_reason":"Integrate brief injection into session loop prompt assembly","dependencies":[{"issue_id":"simple-agent-harness-2pg","depends_on_id":"simple-agent-harness-11h","type":"blocks","created_at":"2026-02-15T13:28:15.084547Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-2su","title":"Implement aider agent adapter","description":"Implement the aider adapter for parsing Aider's session output / chat log. Supported metrics: turns.total, cost.estimate_usd (Aider reports cost), session.output_bytes, session.exit_code, session.duration_secs. Reference: SPEC-v3-agents.md lines 312-319. Key files: src/adapters.rs.","status":"closed","priority":3,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T14:54:22.332329Z","created_by":"Austin King","updated_at":"2026-02-15T18:14:45.589884Z","closed_at":"2026-02-15T18:14:45.589884Z","close_reason":"Implement aider agent adapter","dependencies":[{"issue_id":"simple-agent-harness-2su","depends_on_id":"simple-agent-harness-wi2","type":"blocks","created_at":"2026-02-15T14:56:52.327345Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-33k","title":"Add circular dependency detection for modules","description":"Detect circular dependencies at the module level using the import graph. Module A imports B, B imports A makes affected sets transitive in both directions. Use existing cycle_detect.rs infrastructure if applicable, adapted for module-level (not task-level) cycles. Return list of cycles found. Ref: PRD section 'Circular dependencies'. Depends on import graph parser and module boundary detection.","status":"closed","priority":2,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-15T20:11:07.419559Z","created_by":"Austin King","updated_at":"2026-02-16T00:14:39.487833Z","closed_at":"2026-02-16T00:14:39.487833Z","close_reason":"Add circular dependency detection for modules","dependencies":[{"issue_id":"simple-agent-harness-33k","depends_on_id":"simple-agent-harness-4a1","type":"blocks","created_at":"2026-02-15T20:13:40.015443Z","created_by":"Austin King"},{"issue_id":"simple-agent-harness-33k","depends_on_id":"simple-agent-harness-75u","type":"blocks","created_at":"2026-02-15T20:13:40.133597Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-34d","title":"Add architecture agent configuration knobs","description":"Add configurable knobs to config.rs: fan_in_threshold (default 0.3), integration_loop_max (default 5), expansion_event_threshold (default 5 in 20 tasks), metadata_drift_sensitivity (default 3x increase), refactor_auto_approve (default false). Load from config file or CLI flags. Include conservative and aggressive presets. Ref: PRD section 'Knobs' table. No dependencies — pure config additions.","status":"open","priority":3,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-15T20:13:05.566598Z","created_by":"Austin King","updated_at":"2026-02-15T22:32:46.258854Z"}
{"id":"simple-agent-harness-3dl","title":"Implement status file with atomic JSON writes","description":"Write harness.status as JSON on every state transition. Use atomic write pattern: write to temp file then rename. JSON fields: pid, state, iteration, max_iterations, global_iteration, output_file, output_bytes, session_start, last_update, last_completed_iteration, last_committed, consecutive_rate_limits. States: starting, pre_hooks, session_running, watchdog_kill, retrying, post_hooks, rate_limited_backoff, idle, shutting_down. Acceptance: status file is valid JSON after each state change, rename is atomic. See PRD: Status File section.","status":"closed","priority":2,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-14T23:48:24.730616Z","created_by":"Austin King","updated_at":"2026-02-15T01:14:02.979012Z","closed_at":"2026-02-15T01:14:02.979012Z","close_reason":"Implement status file with atomic JSON writes","dependencies":[{"issue_id":"simple-agent-harness-3dl","depends_on_id":"simple-agent-harness-p0y","type":"blocks","created_at":"2026-02-14T23:50:42.105114Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-3mu","title":"Wire multi-agent coordinator into blacksmith run","description":"When workers.max \u003e 1, blacksmith run transitions from serial loop to coordinated multi-agent mode. Replace the serial loop with coordinator startup. Single-worker mode (workers.max = 1 or omitting [workers]) behaves identically to V2 serial loop. Projects without beads continue to work in single-worker mode with prompt-file workflow. Reference: SPEC-v3-agents.md lines 398-427, 917-919. Key files: src/runner.rs, src/main.rs, src/coordinator.rs.","status":"closed","priority":1,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-15T14:55:27.867079Z","created_by":"Austin King","updated_at":"2026-02-15T15:58:27.575242Z","closed_at":"2026-02-15T15:58:27.575242Z","close_reason":"Wire multi-agent coordinator into blacksmith run","dependencies":[{"issue_id":"simple-agent-harness-3mu","depends_on_id":"simple-agent-harness-1ky","type":"blocks","created_at":"2026-02-15T14:57:06.103894Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-3pa","title":"Implement integration queue and merge-main-into-branch step","description":"Implement sequential integration queue that processes completed worktrees one at a time. In the worker's worktree: merge main into the branch (pull main into branch, NOT push branch to main). Only one integration runs at a time to keep main's history linear. Workers continue coding while one task integrates. Reference: SPEC-v3-agents.md lines 555-607. Key files: src/coordinator.rs, new src/integrator.rs.","status":"closed","priority":1,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T14:54:51.18421Z","created_by":"Austin King","updated_at":"2026-02-15T16:03:58.553383Z","closed_at":"2026-02-15T16:03:58.553383Z","close_reason":"Implement integration queue and merge-main-into-branch step","dependencies":[{"issue_id":"simple-agent-harness-3pa","depends_on_id":"simple-agent-harness-3mu","type":"blocks","created_at":"2026-02-15T14:57:03.839034Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-3su","title":"Implement periodic reconciliation with full test suite","description":"After every N successful integrations (configurable via reconciliation.every, default 3), run the full test suite on main. If failures detected, flag the last N integrated tasks for human review. Add reconciliation.every config field. This catches cross-task semantic bugs that pass individual integration. Reference: SPEC-v3-agents.md lines 609-624. Key files: src/integrator.rs, src/config.rs.","status":"closed","priority":2,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T14:55:27.0182Z","created_by":"Austin King","updated_at":"2026-02-15T17:32:03.000286Z","closed_at":"2026-02-15T17:32:03.000286Z","close_reason":"Implement periodic reconciliation with full test suite","dependencies":[{"issue_id":"simple-agent-harness-3su","depends_on_id":"simple-agent-harness-3pa","type":"blocks","created_at":"2026-02-15T14:57:10.795511Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-4a1","title":"Add codebase import graph parser","description":"Parse Rust use/mod statements to build a directed graph of file-to-file imports. Given a repo root, walk all .rs files, extract imports, and return an adjacency list (HashMap\u003cPathBuf, Vec\u003cPathBuf\u003e\u003e). This is the foundation for fan-in analysis, cycle detection, and blast radius computation in the architecture agent. Should handle: use crate::, mod declarations, pub use re-exports. Ref: PRD section 'Static Analysis of Current Codebase'. Lives in a new src/import_graph.rs.","status":"closed","priority":1,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-15T20:10:39.487643Z","created_by":"Austin King","updated_at":"2026-02-15T23:56:16.737479Z","closed_at":"2026-02-15T23:56:16.737479Z","close_reason":"Verify import graph parser already implemented with 22 passing tests"}
{"id":"simple-agent-harness-4wc","title":"Implement historical signal correlator for architecture agent","description":"Overlay historical signals (expansion events, integration iterations, metadata drift) onto the module graph from structural analysis. Weight recent events more heavily. Identify modules that score high on BOTH structural smells AND historical failure signals as strong refactoring candidates. Modules with only structural smells but no operational problems are left alone. Ref: PRD section 'Analysis Process' steps 2-3. Depends on structural metrics aggregator, expansion event tracking, integration loop tracking, and metadata drift detection.","status":"closed","priority":2,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T20:12:34.866256Z","created_by":"Austin King","updated_at":"2026-02-16T00:37:08.569685Z","closed_at":"2026-02-16T00:37:08.569685Z","close_reason":"Implement historical signal correlator for architecture analysis","dependencies":[{"issue_id":"simple-agent-harness-4wc","depends_on_id":"simple-agent-harness-a9n","type":"blocks","created_at":"2026-02-15T20:13:59.087982Z","created_by":"Austin King"},{"issue_id":"simple-agent-harness-4wc","depends_on_id":"simple-agent-harness-74e","type":"blocks","created_at":"2026-02-15T20:13:59.207399Z","created_by":"Austin King"},{"issue_id":"simple-agent-harness-4wc","depends_on_id":"simple-agent-harness-ldy","type":"blocks","created_at":"2026-02-15T20:13:59.326741Z","created_by":"Austin King"},{"issue_id":"simple-agent-harness-4wc","depends_on_id":"simple-agent-harness-buv","type":"blocks","created_at":"2026-02-15T20:13:59.441583Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-503","title":"Implement retention policy enforcement","description":"Add retention config field supporting last-N, Nd, all, and after-ingest modes. Implement cleanup logic that runs at loop start (step 2): delete compressed files beyond the retention window. last-N keeps N most recent sessions. Nd keeps sessions from last N days by mtime. all never deletes. after-ingest deletes immediately after successful ingestion. Reference: SPEC-v3-agents.md lines 124-169. Key files: src/config.rs, src/runner.rs, src/storage.rs.","status":"closed","priority":2,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T14:53:44.000636Z","created_by":"Austin King","updated_at":"2026-02-15T16:11:58.660387Z","closed_at":"2026-02-15T16:11:58.660387Z","close_reason":"Implement retention policy enforcement with last-N, Nd, all, after-ingest modes","dependencies":[{"issue_id":"simple-agent-harness-503","depends_on_id":"simple-agent-harness-x1a","type":"blocks","created_at":"2026-02-15T14:56:44.102153Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-506","title":"Add progress and ETA to blacksmith run and --status output","description":"Show progress line after each session in blacksmith run: worker states, bead counts, ETA. Single-worker: '[iter N] bead completed in Xm (Y turns) | Progress: A/B beads | avg Xm/bead | ETA: ~Zm'. Multi-worker: worker states + progress + serial vs parallel ETA. Update blacksmith --status to show worker states, progress percentage, remaining beads, serial/parallel ETA, failed beads count. Reference: SPEC-v3-agents.md lines 783-811. Key files: src/runner.rs, src/status.rs, src/coordinator.rs.","status":"closed","priority":2,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T14:56:04.921233Z","created_by":"Austin King","updated_at":"2026-02-15T17:57:05.858077Z","closed_at":"2026-02-15T17:57:05.858077Z","close_reason":"Add progress and ETA to blacksmith run and --status output","dependencies":[{"issue_id":"simple-agent-harness-506","depends_on_id":"simple-agent-harness-ml7","type":"blocks","created_at":"2026-02-15T14:57:16.253057Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-56j","title":"Add improvement recording to agent PROMPT.md workflow","description":"The blacksmith improve add/list infrastructure exists and works, but 0 improvements have been recorded across 73 sessions. The brief shows metrics but no institutional lessons. Need to add instructions to the agent PROMPT.md template telling agents to call 'blacksmith improve add' when they encounter patterns, mistakes, or process insights. Also consider auto-recording improvements from post-session analysis (e.g., if narration% \u003e 40% or cost spikes, auto-record an observation).","status":"closed","priority":1,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-16T00:32:45.342865Z","created_by":"Austin King","updated_at":"2026-02-16T00:40:09.83032Z","closed_at":"2026-02-16T00:40:09.83032Z","close_reason":"Add improvement recording instructions to agent PROMPT.md workflow"}
{"id":"simple-agent-harness-5f1","title":"Add intent analysis data model and cache","description":"Define IntentAnalysis struct with task_id, content_hash (hash of title+description+acceptance criteria), and target_areas (Vec of concept+reasoning pairs). Add DB table and caching layer keyed by content_hash so analysis survives refactors. Intent analysis is the stable, expensive layer that only invalidates when issue content changes. Ref: PRD section 'Layer 1: Intent Analysis'. New file src/intent.rs with DB migration.","status":"closed","priority":1,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T20:11:31.863411Z","created_by":"Austin King","updated_at":"2026-02-15T20:45:08.14605Z","closed_at":"2026-02-15T20:45:08.14605Z","close_reason":"Add intent analysis data model and cache"}
{"id":"simple-agent-harness-5hg","title":"Enable 3 parallel agents in blacksmith.toml","description":"Switch from serial (workers.max=1) to parallel execution with 3 agents. Add [workers] section to blacksmith.toml: max=3, base_branch='main', worktrees_dir='worktrees'. Verify coordinator path is taken (coordinator::run vs runner::run), worktrees are created, and scheduling works with glob-based conflict detection. This is a config change + smoke test, not a code change — all coordinator infrastructure is already implemented. IMPORTANT: After making the config change, touch the STOP file so the running blacksmith process exits cleanly. The operator will then recompile (cargo build --release) and restart blacksmith with the new multi-agent config.","status":"closed","priority":1,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-16T00:34:49.49402Z","created_by":"Austin King","updated_at":"2026-02-16T00:41:42.510506Z","closed_at":"2026-02-16T00:41:42.510506Z","close_reason":"Enable 3 parallel agents in blacksmith.toml","dependencies":[{"issue_id":"simple-agent-harness-5hg","depends_on_id":"simple-agent-harness-m6l","type":"blocks","created_at":"2026-02-16T00:34:54.298356Z","created_by":"Austin King"},{"issue_id":"simple-agent-harness-5hg","depends_on_id":"simple-agent-harness-82c","type":"blocks","created_at":"2026-02-16T00:43:59.711106Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-5x6","title":"Implement --dry-run mode","description":"When --dry-run flag is passed: validate the resolved configuration (after merging CLI \u003e file \u003e defaults), print all resolved settings in a readable format, then exit without starting the loop. Useful for verifying config before long runs. Acceptance: --dry-run prints resolved config and exits 0 on valid config, exits non-zero with error on invalid config. See PRD: CLI Interface.","status":"closed","priority":3,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-14T23:49:40.45134Z","created_by":"Austin King","updated_at":"2026-02-15T14:35:52.544507Z","closed_at":"2026-02-15T14:35:52.544507Z","close_reason":"Implement --dry-run mode with full config display and regex validation","dependencies":[{"issue_id":"simple-agent-harness-5x6","depends_on_id":"simple-agent-harness-utz","type":"blocks","created_at":"2026-02-14T23:50:55.542394Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-6hk","title":"Add adapter config field and auto-detection from command name","description":"Add adapter field to agent config. Implement auto-detection: command containing 'claude' -\u003e claude adapter, 'codex' -\u003e codex, 'opencode' -\u003e opencode, 'aider' -\u003e aider, anything else -\u003e raw. Explicit adapter= overrides auto-detection. Create adapter registry/factory that returns the right adapter. Reference: SPEC-v3-agents.md lines 209-222. Key files: src/config.rs, src/adapters.rs.","status":"closed","priority":1,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T14:53:51.551344Z","created_by":"Austin King","updated_at":"2026-02-15T15:14:22.568885Z","closed_at":"2026-02-15T15:14:22.568885Z","close_reason":"Add adapter config field and auto-detection from command name","dependencies":[{"issue_id":"simple-agent-harness-6hk","depends_on_id":"simple-agent-harness-wi2","type":"blocks","created_at":"2026-02-15T14:56:47.099915Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-74e","title":"Add expansion event tracking for affected-set mismatches","description":"Track expansion events: when a coding agent discovers it needs modules not in its original metadata. Store predicted_modules vs actual_modules with expansion_reason and timestamp. DB table + recording API. Frequent expansions around the same module indicate poor boundary containment. Ref: PRD section 'Affected-set expansions'. Depends on file resolution data model.","status":"closed","priority":2,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T20:12:14.412942Z","created_by":"Austin King","updated_at":"2026-02-15T21:56:46.101717Z","closed_at":"2026-02-15T21:56:46.101717Z","close_reason":"Add expansion event tracking for affected-set mismatches","dependencies":[{"issue_id":"simple-agent-harness-74e","depends_on_id":"simple-agent-harness-0lk","type":"blocks","created_at":"2026-02-15T20:13:51.633049Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-75u","title":"Add module boundary detection from file tree","description":"Given an import graph and file tree, identify module boundaries — groups of files that form a logical unit (e.g., src/auth/ is the 'auth' module). Return a list of Module structs with name, root path, contained files, and whether the module has a mod.rs or lib.rs entry point. This enables the architecture agent to reason about modules rather than individual files. Ref: PRD section 'Static Analysis of Current Codebase'. Depends on import graph parser. Lives in src/import_graph.rs or a new src/module_detect.rs.","status":"closed","priority":1,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-15T20:10:40.676903Z","created_by":"Austin King","updated_at":"2026-02-15T23:58:33.480686Z","closed_at":"2026-02-15T23:58:33.480686Z","close_reason":"Add module boundary detection from file tree","dependencies":[{"issue_id":"simple-agent-harness-75u","depends_on_id":"simple-agent-harness-4a1","type":"blocks","created_at":"2026-02-15T20:13:36.154552Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-7d0","title":"Implement rate limit detection with exponential backoff","description":"Scan session output file for rate limit indicators: JSON 'error:rate_limit', text patterns 'usage limit', 'hit your limit', 'resets.*UTC' (case-insensitive). On detection: increment consecutive rate limit counter, apply exponential backoff (initial_delay * 2^consecutive_count, capped at max_delay_secs), do not increment productive iteration counter. After max_consecutive_rate_limits consecutive rate limits, exit the loop. A successful session resets counter and backoff. Acceptance: rate limit patterns detected correctly, backoff escalates, loop exits after max consecutive. See PRD: Rate Limit Detection section.","status":"closed","priority":3,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-14T23:49:19.661408Z","created_by":"Austin King","updated_at":"2026-02-15T01:58:33.907576Z","closed_at":"2026-02-15T01:58:33.907576Z","close_reason":"Implement rate limit detection with exponential backoff","dependencies":[{"issue_id":"simple-agent-harness-7d0","depends_on_id":"simple-agent-harness-p0y","type":"blocks","created_at":"2026-02-14T23:50:52.427094Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-7ed","title":"Implement blacksmith integration log and retry commands","description":"Add blacksmith integration log [--last N] CLI command showing integration history: assignment ID, bead ID, merge commit, timestamp, manifest entries applied, reconciliation status. Add blacksmith integration retry \u003cbead-id\u003e to retry a failed integration. Reference: SPEC-v3-agents.md lines 848-849. Key files: src/main.rs, src/integrator.rs, src/db.rs.","status":"closed","priority":2,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T14:55:36.839192Z","created_by":"Austin King","updated_at":"2026-02-15T17:40:37.521475Z","closed_at":"2026-02-15T17:40:37.521475Z","close_reason":"Implement blacksmith integration log and retry commands","dependencies":[{"issue_id":"simple-agent-harness-7ed","depends_on_id":"simple-agent-harness-3pa","type":"blocks","created_at":"2026-02-15T14:57:11.948065Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-7rx","title":"Implement signal handling and graceful shutdown","description":"Implement signals.rs: three shutdown triggers. (1) STOP file: checked at top of each iteration, if present log event, delete file, exit. (2) First SIGINT: set flag, finish current session, then exit loop. Print 'Caught SIGINT, finishing current session...'. (3) Second SIGINT within 3s: kill current agent process group immediately, exit. (4) SIGTERM: same as single SIGINT. On any shutdown: persist global iteration counter, write final status. Uses tokio::signal for async signal handling. Acceptance: integration test showing STOP file triggers clean exit. See PRD: Graceful Shutdown section.","status":"closed","priority":1,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-14T23:48:48.437997Z","created_by":"Austin King","updated_at":"2026-02-15T00:17:24.372894Z","closed_at":"2026-02-15T00:17:24.372894Z","close_reason":"Closed","dependencies":[{"issue_id":"simple-agent-harness-7rx","depends_on_id":"simple-agent-harness-utz","type":"blocks","created_at":"2026-02-14T23:50:32.687071Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-82c","title":"Fix session file naming for parallel workers: compress/retention/metrics expect numeric prefixes","description":"In parallel mode, pool.rs names session files 'worker-{id}-{bead_id}.jsonl' but three subsystems assume '{N}.jsonl' numeric naming: (1) compress.rs strips .jsonl and parses prefix as u64 — worker files silently skipped, never compressed. (2) retention.rs/gc.rs same pattern — worker files never garbage collected, accumulate forever. (3) metrics_cmd.rs list_session_files() — worker sessions invisible to 'metrics reingest' and 'metrics status'. Options: (a) change pool.rs to use numeric naming with a global counter, (b) update all three parsers to handle both naming schemes, or (c) use a sub-directory per worker with numeric files inside. Files: src/pool.rs:225, src/compress.rs:43-45, src/retention.rs:153-158, src/gc.rs:273-274, src/metrics_cmd.rs:395-400.","status":"closed","priority":0,"issue_type":"bug","owner":"shout@ozten.com","created_at":"2026-02-16T00:43:55.219054Z","created_by":"Austin King","updated_at":"2026-02-16T00:50:35.803485Z","closed_at":"2026-02-16T00:50:35.803485Z","close_reason":"Fix session file naming: use numeric {N}.jsonl for parallel workers"}
{"id":"simple-agent-harness-83g","title":"Add migration map generation for refactor tasks","description":"When a refactor task completes, produce a structured migration map: file moves (from -\u003e to_split), symbol relocations (old_path -\u003e new_path). This map is used by in-progress worktrees to update their imports after a refactor integrates to main. Ref: PRD section 'The Migration Map'. Depends on import graph parser and module boundary detection.","status":"open","priority":3,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T20:13:03.233454Z","created_by":"Austin King","updated_at":"2026-02-15T20:13:16.200345Z","dependencies":[{"issue_id":"simple-agent-harness-83g","depends_on_id":"simple-agent-harness-4a1","type":"blocks","created_at":"2026-02-15T20:14:08.536963Z","created_by":"Austin King"},{"issue_id":"simple-agent-harness-83g","depends_on_id":"simple-agent-harness-75u","type":"blocks","created_at":"2026-02-15T20:14:08.651742Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-8ff","title":"Implement pre/post-session hook execution","description":"Implement hooks.rs: execute shell commands from config [hooks] pre_session and post_session arrays. Run synchronously before/after each session. Set environment variables: HARNESS_ITERATION, HARNESS_GLOBAL_ITERATION, HARNESS_PROMPT_FILE (pre+post), plus HARNESS_OUTPUT_FILE, HARNESS_EXIT_CODE, HARNESS_OUTPUT_BYTES, HARNESS_SESSION_DURATION, HARNESS_COMMITTED (post only). Pre-session hook failure (non-zero exit) skips the iteration with logged error. Post-session hook failure logs error but continues. Empty retries do NOT trigger post-session hooks. Acceptance: hooks run with correct env vars, failures handled per spec. See PRD: Hooks section.","status":"closed","priority":2,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-14T23:48:49.867764Z","created_by":"Austin King","updated_at":"2026-02-15T01:34:28.791281Z","closed_at":"2026-02-15T01:34:28.791281Z","close_reason":"Implement pre/post-session hook execution with env vars","dependencies":[{"issue_id":"simple-agent-harness-8ff","depends_on_id":"simple-agent-harness-p0y","type":"blocks","created_at":"2026-02-14T23:50:47.74734Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-8iq","title":"Exclude cycled beads from critical path estimation","description":"Modify estimation.rs to exclude cycled beads from the DAG before computing critical path. Use detect_cycles() to identify cycled bead IDs, filter them out of the BeadNode list before parallel_estimate(). Report cycled beads separately in ETA output: 'Progress: 18/24 beads | ETA: ~8m @ 3 workers / warning 3 beads stuck in dependency cycle (not included in estimate)'. If cycle is broken during run, next estimation pass includes freed beads. See PRD: prd/SPEC-v3-agents.md lines 761-773.","status":"closed","priority":2,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-15T18:29:58.38058Z","created_by":"Austin King","updated_at":"2026-02-15T20:05:07.707925Z","closed_at":"2026-02-15T20:05:07.707925Z","close_reason":"Use cycle_detect::detect_cycles() in estimation.rs instead of inline Kahn's","dependencies":[{"issue_id":"simple-agent-harness-8iq","depends_on_id":"simple-agent-harness-9xv","type":"blocks","created_at":"2026-02-15T18:30:30.046316Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-8j5","title":"Implement built-in JSONL metric extraction for turns, cost, and duration","description":"Implement a JSONL parser that reads Claude session output files and extracts built-in metrics: turns.total (count of assistant events), turns.narration_only (assistant events with text but no tool_use), turns.parallel (assistant events with 2+ tool_use blocks), turns.tool_calls (total tool_use blocks), cost.input_tokens/output_tokens/estimate_usd (from usage data), session.output_bytes (file size), session.exit_code. Write extracted metrics as events to the events table. Update observations table. PRD ref: Built-in Metrics, Event Kinds. Files: new src/ingest.rs, src/db.rs (event insert helpers).","status":"closed","priority":1,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T13:27:30.612248Z","created_by":"Austin King","updated_at":"2026-02-15T14:07:06.778686Z","closed_at":"2026-02-15T14:07:06.778686Z","close_reason":"Implement built-in JSONL metric extraction for turns, cost, and duration","dependencies":[{"issue_id":"simple-agent-harness-8j5","depends_on_id":"simple-agent-harness-cl6","type":"blocks","created_at":"2026-02-15T13:28:17.903237Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-90v","title":"Implement ensure_fresh_metadata for scheduler integration","description":"Implement the ensure_fresh_metadata() function from the PRD: check intent cache (keyed by content_hash), check resolution cache (keyed by commit hash), regenerate as needed, return combined TaskMetadata. Wire this into the scheduler so tasks get fresh metadata before assignment. Ref: PRD section 'Regeneration Strategy' code sample. Depends on metadata regeneration strategy, LLM intent analysis, and file resolution implementation.","status":"closed","priority":2,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T20:12:00.877925Z","created_by":"Austin King","updated_at":"2026-02-16T00:23:49.841224Z","closed_at":"2026-02-16T00:23:49.841224Z","close_reason":"Implement ensure_fresh_metadata for scheduler integration","dependencies":[{"issue_id":"simple-agent-harness-90v","depends_on_id":"simple-agent-harness-n1d","type":"blocks","created_at":"2026-02-15T20:13:50.268339Z","created_by":"Austin King"},{"issue_id":"simple-agent-harness-90v","depends_on_id":"simple-agent-harness-d42","type":"blocks","created_at":"2026-02-15T20:13:50.380935Z","created_by":"Austin King"},{"issue_id":"simple-agent-harness-90v","depends_on_id":"simple-agent-harness-ikw","type":"blocks","created_at":"2026-02-15T20:13:50.495952Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-9cm","title":"Implement metrics rebuild command to regenerate observations from events","description":"Implement 'blacksmith metrics rebuild' command that drops and recreates the observations table from events. Useful after manual event edits or migration. PRD ref: Observations Table \u003e Rebuild command. Files: src/metrics_cmd.rs, src/db.rs (rebuild_observations function).","status":"closed","priority":3,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-15T13:27:43.027635Z","created_by":"Austin King","updated_at":"2026-02-15T14:48:31.081247Z","closed_at":"2026-02-15T14:48:31.081247Z","close_reason":"Implement metrics rebuild command to regenerate observations from events","dependencies":[{"issue_id":"simple-agent-harness-9cm","depends_on_id":"simple-agent-harness-cl6","type":"blocks","created_at":"2026-02-15T13:28:34.799168Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-9jw","title":"Wire adapter into ingest pipeline replacing hardcoded parsing","description":"Replace the hardcoded Claude JSONL parsing in the ingest pipeline with calls through the AgentAdapter trait. The ingest module should receive an adapter instance and call extract_builtin_metrics() and lines_for_source() instead of directly parsing Claude format. Configurable extraction rules ([metrics.extract]) should use lines_for_source() to get source text. Reference: SPEC-v3-agents.md lines 226-261. Key files: src/ingest.rs, src/runner.rs.","status":"closed","priority":1,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-15T14:53:59.576852Z","created_by":"Austin King","updated_at":"2026-02-15T15:35:08.56575Z","closed_at":"2026-02-15T15:35:08.56575Z","close_reason":"Wire adapter into ingest pipeline replacing hardcoded parsing","dependencies":[{"issue_id":"simple-agent-harness-9jw","depends_on_id":"simple-agent-harness-wi2","type":"blocks","created_at":"2026-02-15T14:56:48.650301Z","created_by":"Austin King"},{"issue_id":"simple-agent-harness-9jw","depends_on_id":"simple-agent-harness-6hk","type":"blocks","created_at":"2026-02-15T14:56:49.896521Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-9ob","title":"Recover orphaned in_progress beads on coordinator startup","description":"When blacksmith crashes or is killed, beads marked in_progress stay stuck. On restart, bd ready only returns open beads, so orphaned in_progress beads are invisible to the scheduler forever. Fix: after acquiring singleton lock on coordinator startup, query bd list --status=in_progress. For each in_progress bead with no active worker, run bd update \u003cid\u003e --status=open. Since the singleton lock guarantees no other coordinator is running, any in_progress bead without a worker is guaranteed orphaned. This must be a harness mechanism, not a prompt-based approach.","status":"closed","priority":0,"issue_type":"bug","owner":"shout@ozten.com","created_at":"2026-02-15T22:28:02.279117Z","created_by":"Austin King","updated_at":"2026-02-15T23:54:53.607275Z","closed_at":"2026-02-15T23:54:53.607275Z","close_reason":"Verify orphaned bead recovery already implemented and passing","dependencies":[{"issue_id":"simple-agent-harness-9ob","depends_on_id":"simple-agent-harness-ckq","type":"blocks","created_at":"2026-02-15T22:28:07.142615Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-9xc","title":"Add god file detection via cohesion analysis","description":"Detect files exceeding a size threshold that contain multiple unrelated concerns. Measure internal cohesion by checking whether symbols defined in a file reference each other or form independent clusters. A file with 3+ independent symbol clusters above a line threshold is a god file candidate. Ref: PRD section 'God files'. Depends on import graph parser and public API surface extractor.","status":"closed","priority":2,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-15T20:11:06.251Z","created_by":"Austin King","updated_at":"2026-02-16T00:11:57.303507Z","closed_at":"2026-02-16T00:11:57.303507Z","close_reason":"Add god file detection via cohesion analysis","dependencies":[{"issue_id":"simple-agent-harness-9xc","depends_on_id":"simple-agent-harness-4a1","type":"blocks","created_at":"2026-02-15T20:13:38.183444Z","created_by":"Austin King"},{"issue_id":"simple-agent-harness-9xc","depends_on_id":"simple-agent-harness-ehy","type":"blocks","created_at":"2026-02-15T20:13:38.3007Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-9xv","title":"Implement cycle detection algorithms (Kahn's + Tarjan's SCC) in cycle_detect.rs","description":"Create new src/cycle_detect.rs module with BeadNode struct and detect_cycles() function. Phase 1: Kahn's algorithm (BFS topological sort, ~40 lines) identifies nodes involved in cycles by draining nodes with in-degree 0. Phase 2: Tarjan's SCC (~50 lines) decomposes remaining nodes into individual strongly connected components for reporting. Returns Vec\u003cVec\u003cString\u003e\u003e of cycle groups. Pure std library code, zero external deps. Include comprehensive unit tests for: no cycles (DAG), single cycle, multiple independent cycles, self-loops, complex graph with both cycled and non-cycled nodes. Reuse or align with existing BeadNode in src/estimation.rs. See PRD: prd/SPEC-v3-agents.md lines 724-757.","status":"closed","priority":2,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T18:29:55.741395Z","created_by":"Austin King","updated_at":"2026-02-15T18:34:18.800657Z","closed_at":"2026-02-15T18:34:18.800657Z","close_reason":"Implement cycle detection algorithms (Kahn's + Tarjan's SCC) in cycle_detect.rs"}
{"id":"simple-agent-harness-a9n","title":"Implement structural metrics aggregator for architecture analysis","description":"Compute all structural metrics for all modules in one pass: fan-in scores, file sizes, cohesion scores, cycle participation, API surface width. Return a StructuralReport with per-module and per-file metrics. This is step 1 of the architecture analysis pipeline. Ref: PRD section 'Analysis Process' step 1. Depends on fan-in scoring, god file detection, circular dep detection, boundary violation detector, and public API surface extractor.","status":"closed","priority":2,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T20:12:33.701716Z","created_by":"Austin King","updated_at":"2026-02-16T00:31:07.391676Z","closed_at":"2026-02-16T00:31:07.391676Z","close_reason":"Implement structural metrics aggregator for architecture analysis","dependencies":[{"issue_id":"simple-agent-harness-a9n","depends_on_id":"simple-agent-harness-q5v","type":"blocks","created_at":"2026-02-15T20:13:57.428399Z","created_by":"Austin King"},{"issue_id":"simple-agent-harness-a9n","depends_on_id":"simple-agent-harness-9xc","type":"blocks","created_at":"2026-02-15T20:13:57.545802Z","created_by":"Austin King"},{"issue_id":"simple-agent-harness-a9n","depends_on_id":"simple-agent-harness-33k","type":"blocks","created_at":"2026-02-15T20:13:57.663598Z","created_by":"Austin King"},{"issue_id":"simple-agent-harness-a9n","depends_on_id":"simple-agent-harness-aol","type":"blocks","created_at":"2026-02-15T20:13:57.782585Z","created_by":"Austin King"},{"issue_id":"simple-agent-harness-a9n","depends_on_id":"simple-agent-harness-ehy","type":"blocks","created_at":"2026-02-15T20:13:57.90563Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-agq","title":"Clean up dead code warnings across codebase","description":"Remove dead code identified by rustc warnings: unused functions, structs, fields, and enum variants across db.rs, mod.rs, integrator.rs, ingest.rs, config.rs, and session.rs","status":"closed","priority":3,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-15T18:23:40.366202Z","created_by":"Austin King","updated_at":"2026-02-15T18:28:46.991182Z","closed_at":"2026-02-15T18:28:46.991182Z","close_reason":"Clean up dead code warnings"}
{"id":"simple-agent-harness-aol","title":"Add boundary violation detector for module imports","description":"Detect modules reaching into each other's internals rather than using public APIs. Check whether imports reference pub items or reach through pub(crate)/non-public paths. Return a list of boundary violations with source module, target module, and the non-public symbol accessed. Ref: PRD section 'Boundary violations'. Depends on import graph parser, module boundary detection, and public API surface extractor.","status":"closed","priority":2,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-15T20:11:09.058674Z","created_by":"Austin King","updated_at":"2026-02-16T00:17:45.232219Z","closed_at":"2026-02-16T00:17:45.232219Z","close_reason":"Add boundary violation detector for module imports","dependencies":[{"issue_id":"simple-agent-harness-aol","depends_on_id":"simple-agent-harness-4a1","type":"blocks","created_at":"2026-02-15T20:13:40.247565Z","created_by":"Austin King"},{"issue_id":"simple-agent-harness-aol","depends_on_id":"simple-agent-harness-75u","type":"blocks","created_at":"2026-02-15T20:13:40.358764Z","created_by":"Austin King"},{"issue_id":"simple-agent-harness-aol","depends_on_id":"simple-agent-harness-ehy","type":"blocks","created_at":"2026-02-15T20:13:40.468368Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-as9","title":"Implement migration map application to in-progress worktrees","description":"When a refactor integrates to main and another agent has an in-progress worktree: (1) notify the agent of structural changes, (2) provide the migration map, (3) mechanically apply symbol relocations (find-and-replace on import paths), (4) merge main into the branch, (5) run fix loop. If fix loop exceeds N iterations after migration, abort and re-queue. Ref: PRD section 'Handling the In-Progress Agent'. Depends on migration map generation.","status":"open","priority":3,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T20:13:04.354733Z","created_by":"Austin King","updated_at":"2026-02-15T20:13:19.00037Z","dependencies":[{"issue_id":"simple-agent-harness-as9","depends_on_id":"simple-agent-harness-83g","type":"blocks","created_at":"2026-02-15T20:14:08.766028Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-buv","title":"Add metadata drift detection between regenerations","description":"Detect when layer-2 regeneration produces significantly different results for the same layer-1 intent. If the same concept resolves to 3 files one week and 11 files the next, module boundaries are expanding. Compare old and new file resolution results and flag drift above a configurable threshold (default 3x increase). Ref: PRD section 'Metadata drift'. Depends on file resolution data model and metadata regeneration strategy.","status":"closed","priority":2,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T20:12:16.718406Z","created_by":"Austin King","updated_at":"2026-02-16T00:26:29.306499Z","closed_at":"2026-02-16T00:26:29.306499Z","close_reason":"Add metadata drift detection between regenerations","dependencies":[{"issue_id":"simple-agent-harness-buv","depends_on_id":"simple-agent-harness-0lk","type":"blocks","created_at":"2026-02-15T20:13:51.746396Z","created_by":"Austin King"},{"issue_id":"simple-agent-harness-buv","depends_on_id":"simple-agent-harness-n1d","type":"blocks","created_at":"2026-02-15T20:13:51.85815Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-c37","title":"Implement blacksmith metrics beads per-bead timing report","description":"Add blacksmith metrics beads CLI command showing per-bead timing: bead ID, status, sessions, wall time, turns, title in a table format. Show totals: X closed (Ym), Z open. Show averages: Xm/bead, Y turns/bead. Show fastest and slowest beads. Query data from bead_metrics table. Reference: SPEC-v3-agents.md lines 816-830. Key files: src/main.rs, src/metrics_cmd.rs, src/db.rs.","status":"closed","priority":3,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T14:56:13.510653Z","created_by":"Austin King","updated_at":"2026-02-15T18:22:24.400858Z","closed_at":"2026-02-15T18:22:24.400858Z","close_reason":"Implement metrics beads per-bead timing report","dependencies":[{"issue_id":"simple-agent-harness-c37","depends_on_id":"simple-agent-harness-dgh","type":"blocks","created_at":"2026-02-15T14:57:17.514301Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-cgo","title":"Add refactor proposal generation from architecture analysis","description":"For each candidate module identified by the correlator, generate a specific refactor proposal in the format from the PRD: kind (split_module, extract_interface, etc.), priority, confidence score, target file/module with current metrics, evidence (expansion_events count, avg integration iterations, entangled rollbacks, metadata drift), and a concrete recommendation with suggested new structure. Ref: PRD section 'Proposal Format'. Depends on historical signal correlator.","status":"open","priority":2,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T20:12:36.114374Z","created_by":"Austin King","updated_at":"2026-02-15T20:12:52.527118Z","dependencies":[{"issue_id":"simple-agent-harness-cgo","depends_on_id":"simple-agent-harness-4wc","type":"blocks","created_at":"2026-02-15T20:14:00.903061Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-ckq","title":"Coordinator singleton lock: prevent multiple blacksmith instances from running concurrently","description":"Multiple blacksmith coordinator processes can run simultaneously with no mutual exclusion. This causes: (1) duplicate workers spawned for the same bead across separate tmp dirs, (2) blocked beads getting scheduled because multiple coordinators race on bd ready, (3) the same bead assigned to multiple workers simultaneously. Root cause: no PID file or flock-based singleton lock. Fix: acquire an exclusive lock on .blacksmith/lock at coordinator startup. If the lock is held, exit with a clear error showing the existing PID. Release on exit (or stale-detect via PID liveness check).","notes":"Reopened: session 50 closed this but the code doesn't compile. fs2 crate missing from Cargo.toml, singleton.rs has unresolved imports, DataDir::lock() doesn't exist. The lock is not functional — multiple coordinators still spawn concurrently.","status":"closed","priority":0,"issue_type":"bug","owner":"shout@ozten.com","created_at":"2026-02-15T20:18:08.127308Z","created_by":"Austin King","updated_at":"2026-02-15T22:13:59.856992Z","closed_at":"2026-02-15T22:13:59.856992Z","close_reason":"Verify singleton lock is fully implemented and functional"}
{"id":"simple-agent-harness-cl6","title":"Create events and observations tables in database module","description":"Add events table (id, ts, session, kind, value, tags) and observations table (session PK, ts, duration, outcome, data JSON) to the database module. Create indexes on events(session), events(kind), events(ts). Observations is a materialized per-session summary. Add insert/query functions for both tables. PRD ref: Storage Model \u003e Events Table, Observations Table. Files: src/db.rs.","status":"closed","priority":1,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-15T13:27:28.971673Z","created_by":"Austin King","updated_at":"2026-02-15T14:03:25.154817Z","closed_at":"2026-02-15T14:03:25.154817Z","close_reason":"Add events and observations tables with insert/query functions and indexes","dependencies":[{"issue_id":"simple-agent-harness-cl6","depends_on_id":"simple-agent-harness-sxy","type":"blocks","created_at":"2026-02-15T13:28:16.337262Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-cqf","title":"Surface cycle warnings in CLI status output","description":"Surface cycle warnings prominently in two places: (1) blacksmith run status line: 'Progress: 18/21 schedulable beads | ETA: ~6m @ 2 workers / warning 3 beads in dependency cycle -- run bd dep cycles to fix'. (2) blacksmith --status output: 'Schedulable: 21 beads (3 excluded -- dependency cycle) / warning Cycle: 3 beads (run bd dep cycles)'. Format cycle details showing the cycle path. See PRD: prd/SPEC-v3-agents.md lines 775-796.","status":"closed","priority":2,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-15T18:30:00.078288Z","created_by":"Austin King","updated_at":"2026-02-15T20:07:27.152551Z","closed_at":"2026-02-15T20:07:27.152551Z","close_reason":"Surface cycle warnings in CLI run progress line","dependencies":[{"issue_id":"simple-agent-harness-cqf","depends_on_id":"simple-agent-harness-9xv","type":"blocks","created_at":"2026-02-15T18:30:30.164299Z","created_by":"Austin King"},{"issue_id":"simple-agent-harness-cqf","depends_on_id":"simple-agent-harness-fyx","type":"blocks","created_at":"2026-02-15T18:30:35.472911Z","created_by":"Austin King"},{"issue_id":"simple-agent-harness-cqf","depends_on_id":"simple-agent-harness-8iq","type":"blocks","created_at":"2026-02-15T18:30:35.589532Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-d2q","title":"Implement dynamic affected set expansion via .blacksmith-expand","description":"Watch for .blacksmith-expand file in each worker's worktree. When it appears, read new file globs from it, add them to the task's affected set in the coordinator database. Future scheduling decisions account for the expanded set. The request is always granted (optimistic concurrency). If expansion creates overlap with in-progress task, conflict is resolved at integration time. Reference: SPEC-v3-agents.md lines 493-507. Key files: src/coordinator.rs.","status":"closed","priority":2,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T14:55:09.281514Z","created_by":"Austin King","updated_at":"2026-02-15T17:24:50.698656Z","closed_at":"2026-02-15T17:24:50.698656Z","close_reason":"Implement dynamic affected set expansion via .blacksmith-expand","dependencies":[{"issue_id":"simple-agent-harness-d2q","depends_on_id":"simple-agent-harness-1ky","type":"blocks","created_at":"2026-02-15T14:57:03.450145Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-d3v","title":"Implement session spawning and output capture","description":"Implement session.rs: spawn the agent subprocess using tokio::process::Command. Construct the command from config [agent] section, replacing {prompt} placeholder with actual prompt content. Pipe stdout and stderr to a JSONL output file named {output_prefix}-{global_iteration}.jsonl. Track the child PID and process group for later cleanup. Provide an async function that returns SessionResult with exit_code, output_bytes, duration. Acceptance: can spawn a simple command (e.g. echo), capture its output to a file, and report correct exit code and byte count. See PRD: Session Lifecycle, Architecture.","status":"closed","priority":1,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-14T23:48:19.006921Z","created_by":"Austin King","updated_at":"2026-02-15T00:06:54.404814Z","closed_at":"2026-02-15T00:06:54.404814Z","close_reason":"Closed","dependencies":[{"issue_id":"simple-agent-harness-d3v","depends_on_id":"simple-agent-harness-utz","type":"blocks","created_at":"2026-02-14T23:50:28.653853Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-d42","title":"Implement LLM-based intent analysis for tasks","description":"Implement the LLM call that reads a task/issue description and produces an IntentAnalysis — a list of semantic concept areas the task touches (e.g., 'auth_endpoints', 'middleware_stack', 'config'). Use existing LLM adapter infrastructure. Cache results keyed by content_hash. Only re-run when issue content changes. Ref: PRD section 'Layer 1: Intent Analysis'. Depends on intent analysis data model.","status":"closed","priority":1,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T20:11:33.149234Z","created_by":"Austin King","updated_at":"2026-02-15T21:21:03.376586Z","closed_at":"2026-02-15T21:21:03.376586Z","close_reason":"Implement LLM-based intent analysis with caching","dependencies":[{"issue_id":"simple-agent-harness-d42","depends_on_id":"simple-agent-harness-5f1","type":"blocks","created_at":"2026-02-15T20:13:46.575815Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-dfe","title":"Implement git revert rollback with entanglement tracking","description":"Implement rollback for integrated tasks: git revert handles code changes, manifest entries must also be reversed (remove pub mod, Cargo.toml dep, re-export). Track cross-task imports created during integration for entanglement-aware rollback ordering (can't revert A if B imports from A's module). Store cross_task_imports in integration_log. Reference: SPEC-v3-agents.md lines 659-665. Key files: src/integrator.rs, src/db.rs.","status":"closed","priority":2,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T14:55:45.713332Z","created_by":"Austin King","updated_at":"2026-02-15T17:46:59.875521Z","closed_at":"2026-02-15T17:46:59.875521Z","close_reason":"Implement git revert rollback with entanglement tracking","dependencies":[{"issue_id":"simple-agent-harness-dfe","depends_on_id":"simple-agent-harness-yg5","type":"blocks","created_at":"2026-02-15T14:57:13.075999Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-dgh","title":"Implement session-to-bead attribution","description":"Multi-agent mode: attribution is explicit from worker_assignments table. Single-agent mode: infer attribution using file timestamps (ctime=start, mtime=end) and git commit correlation (scan git log --after/--before for bead IDs in commit subjects). Fallback: scan session JSONL result text for bead ID mentions. Store attributed bead_id as session.bead_id event during ingestion. Update bead_metrics table with cumulative timing. Reference: SPEC-v3-agents.md lines 724-748. Key files: src/ingest.rs, src/db.rs, src/coordinator.rs.","status":"closed","priority":2,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T14:55:36.225144Z","created_by":"Austin King","updated_at":"2026-02-15T17:36:23.21126Z","closed_at":"2026-02-15T17:36:23.21126Z","close_reason":"Implement session-to-bead attribution","dependencies":[{"issue_id":"simple-agent-harness-dgh","depends_on_id":"simple-agent-harness-zl7","type":"blocks","created_at":"2026-02-15T14:57:07.381404Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-drr","title":"Add proposal validation checks before creating refactor tasks","description":"Before a proposal becomes a refactor task, validate: (1) dependency feasibility — does the proposed split create circular deps? (2) API surface preservation — do all consumers still have access? (3) test coverage — are there tests for the boundaries being changed? (4) conflict check — would the refactor conflict with in-progress tasks? Proposals that pass become refactor issues in the tracker. Ref: PRD section 'Proposal Validation'. Depends on refactor proposal generation and import graph parser.","status":"open","priority":2,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T20:12:37.730447Z","created_by":"Austin King","updated_at":"2026-02-15T20:12:55.595238Z","dependencies":[{"issue_id":"simple-agent-harness-drr","depends_on_id":"simple-agent-harness-cgo","type":"blocks","created_at":"2026-02-15T20:14:01.020089Z","created_by":"Austin King"},{"issue_id":"simple-agent-harness-drr","depends_on_id":"simple-agent-harness-4a1","type":"blocks","created_at":"2026-02-15T20:14:01.143101Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-e2l","title":"Implement raw adapter with pass-through extraction","description":"Implement the raw adapter that does no format-specific parsing. Zero built-in metrics extracted (only session.output_bytes, session.exit_code, session.duration_secs from the harness). All ExtractionSource variants map to raw file lines. This is the fallback adapter for unrecognized agents. Reference: SPEC-v3-agents.md lines 321-332. Key files: src/adapters.rs.","status":"closed","priority":2,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T14:53:42.158843Z","created_by":"Austin King","updated_at":"2026-02-15T16:08:17.219336Z","closed_at":"2026-02-15T16:08:17.219336Z","close_reason":"Raw adapter already fully implemented - verified and closed","dependencies":[{"issue_id":"simple-agent-harness-e2l","depends_on_id":"simple-agent-harness-wi2","type":"blocks","created_at":"2026-02-15T14:56:45.722586Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-ec1","title":"Implement codex agent adapter","description":"Implement the codex adapter for parsing Codex CLI output. Supported metrics: turns.total, turns.tool_calls, session.output_bytes, session.exit_code, session.duration_secs. Not available (gracefully skipped): turns.narration_only, turns.parallel, cost.*. Map tool_commands to shell command invocations in function_call blocks. Reference: SPEC-v3-agents.md lines 286-300. Key files: src/adapters.rs.","status":"closed","priority":3,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T14:54:05.401863Z","created_by":"Austin King","updated_at":"2026-02-15T18:00:46.331735Z","closed_at":"2026-02-15T18:00:46.331735Z","close_reason":"Implement codex agent adapter","dependencies":[{"issue_id":"simple-agent-harness-ec1","depends_on_id":"simple-agent-harness-wi2","type":"blocks","created_at":"2026-02-15T14:56:49.725291Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-edb","title":"Implement config validation with helpful error messages","description":"Add thorough validation to config loading: check that prompt_file exists, output_dir exists or can be created, command binary is in PATH, timeout values are positive, retry counts are non-negative, etc. Produce clear error messages indicating which field is invalid and what values are acceptable. Validate on load so errors surface immediately, not mid-run. Acceptance: invalid config produces clear, actionable error messages. See PRD: Configuration section.","status":"closed","priority":3,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-14T23:49:57.481176Z","created_by":"Austin King","updated_at":"2026-02-15T14:41:52.228991Z","closed_at":"2026-02-15T14:41:52.228991Z","close_reason":"Implement config validation with helpful error messages","dependencies":[{"issue_id":"simple-agent-harness-edb","depends_on_id":"simple-agent-harness-utz","type":"blocks","created_at":"2026-02-14T23:50:58.073222Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-ee2","title":"Implement graceful metric degradation for adapter limitations","description":"When a target or brief references a metric the current adapter doesn't support (checked via supported_metrics()), silently skip it. The metrics targets command shows unavailable metrics as 'N/A (not available from \u003cadapter\u003e adapter)'. This allows a single blacksmith.toml to define targets for all metrics across different agents. Reference: SPEC-v3-agents.md lines 344-357. Key files: src/brief.rs, src/metrics_cmd.rs.","status":"closed","priority":2,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T14:54:08.093032Z","created_by":"Austin King","updated_at":"2026-02-15T17:21:16.41857Z","closed_at":"2026-02-15T17:21:16.41857Z","close_reason":"Implement graceful metric degradation for adapter limitations","dependencies":[{"issue_id":"simple-agent-harness-ee2","depends_on_id":"simple-agent-harness-9jw","type":"blocks","created_at":"2026-02-15T14:56:51.1409Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-ee7","title":"Implement commit detection in session output","description":"Scan session output for commit indicators (bd-finish, git commit success patterns). Set 'committed' field in status file and event log. Used by --status command to show 'committed (bd-finish detected)' for last completed iteration. Patterns should be configurable. Acceptance: committed=true when output contains commit indicators. See PRD: Status File, Event Log sections.","status":"closed","priority":3,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-14T23:49:32.16106Z","created_by":"Austin King","updated_at":"2026-02-15T04:53:28.723337Z","closed_at":"2026-02-15T04:53:28.723337Z","close_reason":"Implement commit detection in session output","dependencies":[{"issue_id":"simple-agent-harness-ee7","depends_on_id":"simple-agent-harness-p0y","type":"blocks","created_at":"2026-02-14T23:50:54.258018Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-ehy","title":"Add public API surface extractor for modules","description":"For each detected module, extract its public API surface: pub fn signatures, pub struct/enum definitions, pub trait definitions. Return a structured representation (ModuleApi { module_name, public_symbols: Vec\u003cSymbol\u003e }). This is used to compute API surface width (a structural smell) and to detect boundary violations. Ref: PRD section 'Wide public API surface' and 'Boundary violations'. Depends on import graph parser and module boundary detection.","status":"closed","priority":2,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-15T20:10:41.84003Z","created_by":"Austin King","updated_at":"2026-02-16T00:05:13.983947Z","closed_at":"2026-02-16T00:05:13.983947Z","close_reason":"Add public API surface extractor for modules","dependencies":[{"issue_id":"simple-agent-harness-ehy","depends_on_id":"simple-agent-harness-4a1","type":"blocks","created_at":"2026-02-15T20:13:36.272192Z","created_by":"Austin King"},{"issue_id":"simple-agent-harness-ehy","depends_on_id":"simple-agent-harness-75u","type":"blocks","created_at":"2026-02-15T20:13:36.387677Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-evl","title":"Implement improve add and improve list CLI subcommands","description":"Add clap subcommand structure: blacksmith improve add/list. The 'add' command takes title (positional), --category (required), --body, --context, --tags. Auto-assigns next ref (R1, R2, ...). The 'list' command supports --status and --category filters, displays in table format. Wire subcommands into main.rs CLI. PRD ref: CLI Interface \u003e Improvement commands. Files: src/main.rs (CLI struct), src/db.rs (insert/query), new src/improve.rs (command handlers).","status":"closed","priority":1,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T13:27:15.855783Z","created_by":"Austin King","updated_at":"2026-02-15T13:55:59.763899Z","closed_at":"2026-02-15T13:55:59.763899Z","close_reason":"Implement improve add and improve list CLI subcommands","dependencies":[{"issue_id":"simple-agent-harness-evl","depends_on_id":"simple-agent-harness-sxy","type":"blocks","created_at":"2026-02-15T13:28:08.070976Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-ewc","title":"Scaffold Rust project with Cargo.toml and module stubs","description":"Set up the Rust project skeleton. Create Cargo.toml with all dependencies (clap, serde, toml, tokio, nix, chrono, serde_json, tracing, tracing-subscriber). Create src/ with stub files: main.rs, config.rs, runner.rs, session.rs, watchdog.rs, retry.rs, metrics.rs, signals.rs, hooks.rs. main.rs should have a minimal clap CLI that compiles and prints help. Include a default harness.toml with all config sections from the PRD. Acceptance: 'cargo build' succeeds, 'cargo run -- --help' prints usage.","status":"closed","priority":0,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-14T23:47:23.476559Z","created_by":"Austin King","updated_at":"2026-02-15T00:00:09.247912Z","closed_at":"2026-02-15T00:00:09.247912Z","close_reason":"Scaffold complete: cargo build succeeds, cargo run -- --help prints usage"}
{"id":"simple-agent-harness-f9m","title":"Implement worker pool manager for spawning and tracking workers","description":"Implement worker pool that manages up to workers.max concurrent agent sessions. Each worker runs in its own worktree. Track worker state: idle, coding, integrating, completed, failed. Spawn agent sessions in worktrees using the agent.coding config. Detect worker completion (process exit). Queue completed worktrees for integration. Add workers.max config field (default 1). Reference: SPEC-v3-agents.md lines 430-436, 509-549. Key files: src/coordinator.rs, src/config.rs, src/session.rs.","status":"closed","priority":1,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T14:54:50.954832Z","created_by":"Austin King","updated_at":"2026-02-15T15:49:29.798145Z","closed_at":"2026-02-15T15:49:29.798145Z","close_reason":"Implement worker pool manager for spawning and tracking workers","dependencies":[{"issue_id":"simple-agent-harness-f9m","depends_on_id":"simple-agent-harness-zl7","type":"blocks","created_at":"2026-02-15T14:56:57.713177Z","created_by":"Austin King"},{"issue_id":"simple-agent-harness-f9m","depends_on_id":"simple-agent-harness-1jv","type":"blocks","created_at":"2026-02-15T14:56:58.877989Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-fgf","title":"Implement --status CLI command","description":"When --status flag is passed, read harness.status JSON file and display formatted output: loop state, current iteration/max, global iteration, session output size and growth status, uptime, last completed iteration info. Print and exit (do not start the loop). Handle missing status file gracefully with 'No running harness detected'. See PRD: Status Command section.","status":"closed","priority":2,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-14T23:48:33.108264Z","created_by":"Austin King","updated_at":"2026-02-15T01:17:31.758447Z","closed_at":"2026-02-15T01:17:31.758447Z","close_reason":"Implement --status CLI command with formatted status display","dependencies":[{"issue_id":"simple-agent-harness-fgf","depends_on_id":"simple-agent-harness-3dl","type":"blocks","created_at":"2026-02-14T23:50:43.334863Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-fvr","title":"Implement watchdog output-growth monitor","description":"Implement watchdog.rs: a tokio task that monitors the output file for growth. Algorithm: record initial size, check every check_interval_secs, reset stale timer on growth, kill process group after stale_timeout_mins of no growth. Process cleanup: SIGTERM to process group, wait 5s, SIGKILL if still alive, collect exit status. Return exit code 124 on timeout kill. Uses nix crate for signal/process group management. Acceptance: unit test with a mock slow-writing process that gets killed after stale timeout. See PRD: Watchdog section.","status":"closed","priority":1,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-14T23:48:29.04948Z","created_by":"Austin King","updated_at":"2026-02-15T00:10:59.0807Z","closed_at":"2026-02-15T00:10:59.0807Z","close_reason":"Closed","dependencies":[{"issue_id":"simple-agent-harness-fvr","depends_on_id":"simple-agent-harness-d3v","type":"blocks","created_at":"2026-02-14T23:50:29.92715Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-fyx","title":"Wire cycle detection into coordinator scheduling pass","description":"Modify coordinator.rs scheduling pass to call cycle_detect::detect_cycles() on every scheduling pass (not just startup). Build dependency graph from bd list JSON output (dependencies array already available in parse_ready_beads_json). Filter cycled beads out of the scheduling pool before passing to next_assignable_tasks(). Log each detected cycle with full path (A -\u003e B -\u003e C -\u003e A). Self-healing: cycles broken mid-run via bd dep rm are picked up on next pass automatically. See PRD: prd/SPEC-v3-agents.md lines 685-722.","status":"closed","priority":2,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-15T18:29:57.183165Z","created_by":"Austin King","updated_at":"2026-02-15T19:33:13.127139Z","closed_at":"2026-02-15T19:33:13.127139Z","close_reason":"Verified cycle detection already wired into coordinator scheduling pass","dependencies":[{"issue_id":"simple-agent-harness-fyx","depends_on_id":"simple-agent-harness-9xv","type":"blocks","created_at":"2026-02-15T18:30:29.929937Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-h97","title":"Add target miss warnings and streak detection to brief output","description":"Extend brief output to auto-generate warnings when targets are missed. Include streak detection: escalate warnings after N consecutive misses (configurable). Format per PRD brief example. PRD ref: Milestone 3 bullet points. Files: src/brief.rs, src/config.rs (streak config).","status":"closed","priority":2,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T13:27:40.106578Z","created_by":"Austin King","updated_at":"2026-02-15T14:34:08.657923Z","closed_at":"2026-02-15T14:34:08.657923Z","close_reason":"Add target miss warnings and streak detection to brief output","dependencies":[{"issue_id":"simple-agent-harness-h97","depends_on_id":"simple-agent-harness-pcb","type":"blocks","created_at":"2026-02-15T13:28:30.759438Z","created_by":"Austin King"},{"issue_id":"simple-agent-harness-h97","depends_on_id":"simple-agent-harness-obm","type":"blocks","created_at":"2026-02-15T13:28:32.155079Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-hhv","title":"Implement blacksmith metrics reingest command","description":"Add blacksmith metrics reingest CLI subcommand. When extraction rules change, re-ingest historical sessions: decompresses .jsonl.zst files as needed, re-runs extraction through the adapter, and updates the events table. Supports --last N (reingest N most recent) and --all (reingest everything). Only works for sessions that haven't been deleted. Reference: SPEC-v3-agents.md lines 179-187. Key files: src/main.rs, src/metrics_cmd.rs, src/ingest.rs, src/storage.rs.","status":"closed","priority":3,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T14:54:30.097639Z","created_by":"Austin King","updated_at":"2026-02-15T18:19:16.134214Z","closed_at":"2026-02-15T18:19:16.134214Z","close_reason":"Implement metrics reingest command","dependencies":[{"issue_id":"simple-agent-harness-hhv","depends_on_id":"simple-agent-harness-x1a","type":"blocks","created_at":"2026-02-15T14:56:53.587272Z","created_by":"Austin King"},{"issue_id":"simple-agent-harness-hhv","depends_on_id":"simple-agent-harness-9jw","type":"blocks","created_at":"2026-02-15T14:56:54.760465Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-hxq","title":"Add agent.coding and agent.integration config sections","description":"Add [agent.coding] and [agent.integration] config sections. agent.coding configures the agent for creative coding work. agent.integration configures a potentially cheaper/faster model for the integration loop. If agent.integration is omitted, falls back to agent.coding. If neither is set, the legacy [agent] section is used. Deprecate flat [agent] section with a warning but keep it working. Reference: SPEC-v3-agents.md lines 196-223. Key files: src/config.rs, src/runner.rs, src/session.rs.","status":"closed","priority":2,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-15T14:53:56.539643Z","created_by":"Austin King","updated_at":"2026-02-15T17:06:57.023217Z","closed_at":"2026-02-15T17:06:57.023217Z","close_reason":"Add agent.coding and agent.integration config sections with phase-specific resolution"}
{"id":"simple-agent-harness-i9s","title":"Implement configurable extraction rules from TOML config","description":"Parse [metrics.extract.rules] from blacksmith.toml config. Each rule has: kind, pattern (regex), optional anti_pattern, source (tool_commands/text/raw), transform (last_segment/int/trim), first_match, count, emit. Apply rules during JSONL ingestion alongside built-in metrics. Adding a new metric = 3-4 lines of TOML. PRD ref: Configurable Extraction Rules. Files: src/config.rs (new MetricsExtractConfig), src/ingest.rs (apply rules during parse).","status":"closed","priority":2,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T13:27:37.285841Z","created_by":"Austin King","updated_at":"2026-02-15T14:24:50.388679Z","closed_at":"2026-02-15T14:24:50.388679Z","close_reason":"Implement configurable extraction rules from TOML config","dependencies":[{"issue_id":"simple-agent-harness-i9s","depends_on_id":"simple-agent-harness-8j5","type":"blocks","created_at":"2026-02-15T13:28:28.08633Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-ib1","title":"Add storage config and .blacksmith/ directory initialization","description":"Add storage.data_dir config field (default .blacksmith/). Create DataDir struct that manages the directory layout: blacksmith.db, status, counter, sessions/, worktrees/. Implement blacksmith init CLI command that creates the full directory structure and appends .blacksmith/ to .gitignore if not already present. Auto-create on first blacksmith run if missing. Reference: SPEC-v3-agents.md Data Directory section, lines 33-87. Key files: src/config.rs, src/main.rs.","status":"closed","priority":1,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T14:53:08.990315Z","created_by":"Austin King","updated_at":"2026-02-15T15:01:15.846572Z","closed_at":"2026-02-15T15:01:15.846572Z","close_reason":"Add storage config and .blacksmith/ directory initialization"}
{"id":"simple-agent-harness-ikw","title":"Implement file resolution from intent concepts","description":"Map semantic concepts from Layer 1 intent analysis onto concrete files and modules at current HEAD. Use import graph and module boundary detection to resolve concepts like 'auth_endpoints' to specific files. Compute blast_radius by finding transitive dependents in the import graph. This is pure static analysis — no LLM involved. Ref: PRD section 'Layer 2: File Resolution'. Depends on file resolution data model, import graph parser, and module boundary detection.","status":"closed","priority":1,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T20:11:35.661161Z","created_by":"Austin King","updated_at":"2026-02-16T00:01:49.29347Z","closed_at":"2026-02-16T00:01:49.29347Z","close_reason":"Implement file resolution from intent concepts","dependencies":[{"issue_id":"simple-agent-harness-ikw","depends_on_id":"simple-agent-harness-0lk","type":"blocks","created_at":"2026-02-15T20:13:46.691145Z","created_by":"Austin King"},{"issue_id":"simple-agent-harness-ikw","depends_on_id":"simple-agent-harness-4a1","type":"blocks","created_at":"2026-02-15T20:13:46.806122Z","created_by":"Austin King"},{"issue_id":"simple-agent-harness-ikw","depends_on_id":"simple-agent-harness-75u","type":"blocks","created_at":"2026-02-15T20:13:46.920049Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-irr","title":"Add architecture agent trigger system (periodic and threshold)","description":"Implement trigger system for the architecture agent: (1) periodic — run after every N tasks complete (configurable, default 10), (2) threshold-triggered — when rolling averages of expansion events or integration iterations exceed a threshold, (3) pre-planning — before decomposing a large feature into tasks. Wire triggers into coordinator or scheduler. Ref: PRD section 'Analysis Process' triggers. Depends on proposal validation.","status":"open","priority":2,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T20:13:01.893341Z","created_by":"Austin King","updated_at":"2026-02-15T20:13:13.045515Z","dependencies":[{"issue_id":"simple-agent-harness-irr","depends_on_id":"simple-agent-harness-drr","type":"blocks","created_at":"2026-02-15T20:14:01.260019Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-j1w","title":"Implement metrics migrate command for V1 data import","description":"Implement 'blacksmith metrics migrate --from \u003cpath\u003e' to import V1 self-improvement.db data. Map V1 sessions table columns to V2 event kinds per PRD mapping (assistant_turns -\u003e turns.total, etc). Copy improvements rows mapping severity -\u003e category. Rebuild observations after import. PRD ref: Migration from V1. Files: src/metrics_cmd.rs (migrate command), src/db.rs (V1 schema read).","status":"closed","priority":3,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T13:27:41.86492Z","created_by":"Austin King","updated_at":"2026-02-15T14:45:43.086057Z","closed_at":"2026-02-15T14:45:43.086057Z","close_reason":"Implement metrics migrate command for V1 data import","dependencies":[{"issue_id":"simple-agent-harness-j1w","depends_on_id":"simple-agent-harness-cl6","type":"blocks","created_at":"2026-02-15T13:28:33.384002Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-jkn","title":"Implement blacksmith migrate --consolidate command","description":"Add blacksmith migrate --consolidate CLI command for V2-\u003eV3 file migration. Find blacksmith.db/harness.db in old output directory. Move {output_prefix}-*.jsonl files into .blacksmith/sessions/, renaming to {N}.jsonl. Move counter and status files. Print summary of what moved. Non-destructive (move, not copy-delete). Stop and report on failure. Reference: SPEC-v3-agents.md lines 89-100. Key files: src/main.rs, src/storage.rs.","status":"closed","priority":2,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T14:54:02.18888Z","created_by":"Austin King","updated_at":"2026-02-15T17:15:32.25006Z","closed_at":"2026-02-15T17:15:32.25006Z","close_reason":"Implement blacksmith migrate --consolidate command","dependencies":[{"issue_id":"simple-agent-harness-jkn","depends_on_id":"simple-agent-harness-ib1","type":"blocks","created_at":"2026-02-15T14:56:46.562382Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-jr7","title":"Implement retry policy for empty sessions","description":"Implement retry.rs: detect when session output is below min_output_bytes threshold. On empty session: log warning with output size, increment global_iteration (new output filename), re-run session with same prompt, after max_empty_retries failures skip to next iteration. Empty retries do NOT increment productive iteration counter and do NOT trigger post-session hooks. Acceptance: unit test showing retry behavior with configurable thresholds. See PRD: Retry Policy section.","status":"closed","priority":1,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-14T23:48:38.6347Z","created_by":"Austin King","updated_at":"2026-02-15T00:13:47.076532Z","closed_at":"2026-02-15T00:13:47.076532Z","close_reason":"Closed","dependencies":[{"issue_id":"simple-agent-harness-jr7","depends_on_id":"simple-agent-harness-d3v","type":"blocks","created_at":"2026-02-14T23:50:31.225368Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-k53","title":"Integrate automatic post-session JSONL ingestion into loop","description":"Wire automatic JSONL ingestion into the session loop in runner.rs. After each session completes and passes retry evaluation (step 6 in lifecycle), call the ingest module to parse the session output file and write events to blacksmith.db. Pass session number and duration from the harness. Only runs when metrics DB exists. PRD ref: Loop Integration \u003e Post-session: Automatic Ingestion, Loop Lifecycle step 6. Files: src/runner.rs.","status":"closed","priority":1,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-15T13:27:31.893918Z","created_by":"Austin King","updated_at":"2026-02-15T14:10:12.993409Z","closed_at":"2026-02-15T14:10:12.993409Z","close_reason":"Wire automatic JSONL ingestion into runner loop","dependencies":[{"issue_id":"simple-agent-harness-k53","depends_on_id":"simple-agent-harness-8j5","type":"blocks","created_at":"2026-02-15T13:28:19.137505Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-ldy","title":"Add integration loop iteration tracking","description":"Track how many fix-loop iterations each task requires during integration. High iteration counts mean interfaces between modules were unclear or blast radius was underestimated. Store per-task iteration count and which modules were involved. DB table + recording API called from integrator. Ref: PRD section 'Integration loop iterations'. Lives in src/integrator.rs or new src/historical_signals.rs.","status":"closed","priority":2,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T20:12:15.535203Z","created_by":"Austin King","updated_at":"2026-02-15T22:25:42.07923Z","closed_at":"2026-02-15T22:25:42.07923Z","close_reason":"Add integration loop iteration tracking: DB table + recording API + integrator wiring"}
{"id":"simple-agent-harness-m5l","title":"Implement integration agent spawning for compiler fixes","description":"After merge and manifest application, run cargo check / tsc --noEmit. If errors: spawn integration agent (using [agent.integration] config) to apply surgical fixes (missing imports, name collisions). Retry up to 3 times (circuit breaker). Integration uses the same worktree to preserve build artifacts. Reference: SPEC-v3-agents.md lines 571-578. Key files: src/integrator.rs, src/session.rs.","status":"closed","priority":1,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T14:55:10.229199Z","created_by":"Austin King","updated_at":"2026-02-15T17:12:40.723152Z","closed_at":"2026-02-15T17:12:40.723152Z","close_reason":"Implement integration agent spawning with compiler check and fix retry loop","dependencies":[{"issue_id":"simple-agent-harness-m5l","depends_on_id":"simple-agent-harness-3pa","type":"blocks","created_at":"2026-02-15T14:57:05.164828Z","created_by":"Austin King"},{"issue_id":"simple-agent-harness-m5l","depends_on_id":"simple-agent-harness-v6v","type":"blocks","created_at":"2026-02-15T14:57:06.3048Z","created_by":"Austin King"},{"issue_id":"simple-agent-harness-m5l","depends_on_id":"simple-agent-harness-hxq","type":"blocks","created_at":"2026-02-15T14:57:08.012934Z","created_by":"Austin King"},{"issue_id":"simple-agent-harness-m5l","depends_on_id":"simple-agent-harness-t4x","type":"blocks","created_at":"2026-02-15T16:45:38.150394Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-m6l","title":"Wire post-session cargo check gate before bead closure","description":"Agents close beads claiming success without verifying compilation. Session 50 closed the singleton lock P0 bead but singleton.rs doesn't compile (missing fs2 crate). Need a post-session hook or gate that runs 'cargo check' and prevents bead closure if it fails. This should be a built-in harness feature, not reliant on agent discipline. Could be: (1) a post_session hook that runs cargo check, (2) a bd close pre-check that verifies build, or (3) a configurable validation step in the session loop before marking success.","status":"closed","priority":0,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-16T00:32:41.554324Z","created_by":"Austin King","updated_at":"2026-02-16T00:38:40.566669Z","closed_at":"2026-02-16T00:38:40.566669Z","close_reason":"Wire cargo check gate in bd-finish.sh to prevent closing beads with non-compiling code"}
{"id":"simple-agent-harness-mjx","title":"Implement affected set parsing and glob overlap detection","description":"Parse affected sets from bead design field using the convention 'affected: \u003cglob\u003e, \u003cglob\u003e, ...'. Implement globs_overlap() function that checks if two sets of file globs have potential overlap. A bead without an affected set is treated as affecting everything (not parallelizable). Reference: SPEC-v3-agents.md lines 440-483. Key files: new src/coordinator.rs or src/scheduler.rs.","status":"closed","priority":1,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T14:54:32.326556Z","created_by":"Austin King","updated_at":"2026-02-15T15:42:14.592888Z","closed_at":"2026-02-15T15:42:14.592888Z","close_reason":"Implement affected set parsing and glob overlap detection"}
{"id":"simple-agent-harness-ml7","title":"Implement serial and parallel time estimation from bead_metrics","description":"Serial estimate: avg_time = sum(wall_time_secs) / count(closed beads), remaining = count(open) * avg_time. Show 'insufficient data' if \u003c 3 completed beads. Parallel estimate: build dependency DAG, find critical path, parallel_time = max(critical_path_time, serial_time / N) + integration_overhead. Integration_overhead = avg_integration_time * count(open). N = workers.max. Reference: SPEC-v3-agents.md lines 749-778. Key files: src/coordinator.rs or new src/estimation.rs, src/db.rs.","status":"closed","priority":2,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T14:55:54.262895Z","created_by":"Austin King","updated_at":"2026-02-15T17:52:04.958593Z","closed_at":"2026-02-15T17:52:04.958593Z","close_reason":"Implement serial and parallel time estimation from bead_metrics","dependencies":[{"issue_id":"simple-agent-harness-ml7","depends_on_id":"simple-agent-harness-dgh","type":"blocks","created_at":"2026-02-15T14:57:14.484435Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-mxg","title":"Implement prompt prepend_commands for dynamic prompt construction","description":"Support [prompt] config section with file and prepend_commands fields. Read prompt from file, run each prepend command and capture stdout, prepend non-empty outputs to prompt separated by newline-dash-newline. Empty command output is silently skipped. This replaces inline bash logic for injecting performance briefs. Acceptance: prompt is correctly assembled with prepended command outputs. See PRD: Prompt Injection section.","status":"closed","priority":2,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-14T23:49:10.212331Z","created_by":"Austin King","updated_at":"2026-02-15T01:53:18.846511Z","closed_at":"2026-02-15T01:53:18.846511Z","close_reason":"Implement prompt prepend_commands for dynamic prompt construction","dependencies":[{"issue_id":"simple-agent-harness-mxg","depends_on_id":"simple-agent-harness-utz","type":"blocks","created_at":"2026-02-14T23:50:49.043389Z","created_by":"Austin King"},{"issue_id":"simple-agent-harness-mxg","depends_on_id":"simple-agent-harness-d3v","type":"blocks","created_at":"2026-02-14T23:50:50.339371Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-n1d","title":"Add metadata regeneration strategy with lazy invalidation","description":"Implement lazy invalidation strategy: mark layer-2 caches as stale after integration to main. On scheduling, check if base_commit matches current main — if not, regenerate layer 2. After refactor integration, proactively regenerate layer 2 for all pending tasks. Ref: PRD section 'Regeneration Strategy'. Depends on file resolution data model and file resolution implementation.","status":"closed","priority":2,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T20:11:58.907042Z","created_by":"Austin King","updated_at":"2026-02-16T00:20:40.630532Z","closed_at":"2026-02-16T00:20:40.630532Z","close_reason":"Add metadata regeneration strategy with lazy invalidation","dependencies":[{"issue_id":"simple-agent-harness-n1d","depends_on_id":"simple-agent-harness-0lk","type":"blocks","created_at":"2026-02-15T20:13:50.037079Z","created_by":"Austin King"},{"issue_id":"simple-agent-harness-n1d","depends_on_id":"simple-agent-harness-ikw","type":"blocks","created_at":"2026-02-15T20:13:50.152556Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-obm","title":"Implement configurable target thresholds and metrics targets command","description":"Parse [metrics.targets.rules] from blacksmith.toml config. Each rule: kind, compare (pct_of/pct_sessions/avg), relative_to, threshold, direction (above/below), label, unit. Implement 'blacksmith metrics targets' command showing configured targets vs recent performance. PRD ref: Targets and Thresholds, CLI \u003e metrics targets. Files: src/config.rs (new MetricsTargetsConfig), src/metrics_cmd.rs (targets command), src/db.rs (aggregation queries).","status":"closed","priority":2,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T13:27:38.696566Z","created_by":"Austin King","updated_at":"2026-02-15T14:28:40.908971Z","closed_at":"2026-02-15T14:28:40.908971Z","close_reason":"Implement configurable target thresholds and metrics targets command","dependencies":[{"issue_id":"simple-agent-harness-obm","depends_on_id":"simple-agent-harness-cl6","type":"blocks","created_at":"2026-02-15T13:28:29.313453Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-odo","title":"Implement metrics export, query, and events dump commands","description":"Implement three CLI commands: 'blacksmith metrics export [--format csv|json]' to export all observations, 'blacksmith metrics query \u003ckind\u003e [--last N] [--aggregate avg|trend]' for ad-hoc metric queries, and 'blacksmith metrics events [--session N]' to dump raw events. PRD ref: CLI Interface \u003e Metrics commands. Files: src/metrics_cmd.rs, src/db.rs.","status":"closed","priority":3,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T13:27:44.509093Z","created_by":"Austin King","updated_at":"2026-02-15T14:51:49.192492Z","closed_at":"2026-02-15T14:51:49.192492Z","close_reason":"Implement metrics export, query, and events dump commands","dependencies":[{"issue_id":"simple-agent-harness-odo","depends_on_id":"simple-agent-harness-cl6","type":"blocks","created_at":"2026-02-15T13:28:36.094019Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-p0y","title":"Implement main runner loop orchestration","description":"Implement runner.rs: the core loop that ties all modules together. For each iteration: (1) check STOP file, (2) read and prepare prompt from prompt_file, (3) spawn agent session, (4) start watchdog alongside session, (5) on completion check output size and retry if needed, (6) update iteration counters (productive + global), (7) apply inter-iteration delay. Track productive iterations vs max_iterations. The runner owns the iteration state and delegates to session, watchdog, retry, and signals modules. Acceptance: can run N productive iterations with a mock agent command (e.g. 'echo hello'), handles empty sessions with retries, stops on max_iterations. See PRD: Core Behavior, Session Lifecycle.","status":"closed","priority":0,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-14T23:48:58.908464Z","created_by":"Austin King","updated_at":"2026-02-15T00:22:58.535681Z","closed_at":"2026-02-15T00:22:58.535681Z","close_reason":"Closed","dependencies":[{"issue_id":"simple-agent-harness-p0y","depends_on_id":"simple-agent-harness-utz","type":"blocks","created_at":"2026-02-14T23:50:34.058289Z","created_by":"Austin King"},{"issue_id":"simple-agent-harness-p0y","depends_on_id":"simple-agent-harness-d3v","type":"blocks","created_at":"2026-02-14T23:50:35.313584Z","created_by":"Austin King"},{"issue_id":"simple-agent-harness-p0y","depends_on_id":"simple-agent-harness-fvr","type":"blocks","created_at":"2026-02-14T23:50:36.835817Z","created_by":"Austin King"},{"issue_id":"simple-agent-harness-p0y","depends_on_id":"simple-agent-harness-jr7","type":"blocks","created_at":"2026-02-14T23:50:39.029115Z","created_by":"Austin King"},{"issue_id":"simple-agent-harness-p0y","depends_on_id":"simple-agent-harness-7rx","type":"blocks","created_at":"2026-02-14T23:50:40.930624Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-pcb","title":"Add quantitative metrics summary to brief command output","description":"Extend the brief command to include quantitative metrics alongside improvements. Add a '## PERFORMANCE FEEDBACK' section showing last session metrics vs targets (if configured). Format: metric name, current value, target, OK/MISS status. PRD ref: Brief command output example, Loop Integration \u003e Pre-session. Files: src/brief.rs, src/db.rs (recent session query).","status":"closed","priority":2,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T13:27:35.646752Z","created_by":"Austin King","updated_at":"2026-02-15T14:18:39.832457Z","closed_at":"2026-02-15T14:18:39.832457Z","close_reason":"Add quantitative metrics summary to brief command output","dependencies":[{"issue_id":"simple-agent-harness-pcb","depends_on_id":"simple-agent-harness-11h","type":"blocks","created_at":"2026-02-15T13:28:24.801522Z","created_by":"Austin King"},{"issue_id":"simple-agent-harness-pcb","depends_on_id":"simple-agent-harness-pr9","type":"blocks","created_at":"2026-02-15T13:28:26.190926Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-pr9","title":"Implement metrics log and metrics status CLI commands","description":"Implement two CLI commands: 'blacksmith metrics log \u003cfile\u003e' for manual JSONL ingestion (calls the same ingest module), and 'blacksmith metrics status [--last N]' which displays a dashboard showing recent sessions from the observations table with key metrics, trends, and target status. Default --last is 10. PRD ref: CLI Interface \u003e Metrics commands. Files: src/main.rs (wire subcommands), new src/metrics_cmd.rs (command handlers), src/db.rs (query helpers).","status":"closed","priority":1,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T13:27:34.088296Z","created_by":"Austin King","updated_at":"2026-02-15T14:12:39.210778Z","closed_at":"2026-02-15T14:12:39.210778Z","close_reason":"Implement metrics log and metrics status CLI commands","dependencies":[{"issue_id":"simple-agent-harness-pr9","depends_on_id":"simple-agent-harness-cl6","type":"blocks","created_at":"2026-02-15T13:28:20.950162Z","created_by":"Austin King"},{"issue_id":"simple-agent-harness-pr9","depends_on_id":"simple-agent-harness-8j5","type":"blocks","created_at":"2026-02-15T13:28:23.512832Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-q5v","title":"Add fan-in hotspot scoring for files","description":"Compute fan_in_score(file) = count(modules importing file) / total_modules for every file in the codebase. Return a sorted list of files with their fan-in scores. Files above a configurable threshold (default 0.3) are splitting candidates. Ref: PRD section 'Fan-in hotspots'. Depends on import graph parser.","status":"closed","priority":2,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-15T20:11:05.036903Z","created_by":"Austin King","updated_at":"2026-02-16T00:07:39.162935Z","closed_at":"2026-02-16T00:07:39.162935Z","close_reason":"Add fan-in hotspot scoring for files","dependencies":[{"issue_id":"simple-agent-harness-q5v","depends_on_id":"simple-agent-harness-4a1","type":"blocks","created_at":"2026-02-15T20:13:38.067156Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-r43","title":"Implement --quiet mode for minimal output","description":"When --quiet flag is passed, suppress per-iteration banners and info-level messages. Only show errors and the final summary line. Integrate with tracing subscriber to filter log levels based on quiet/verbose flags: --quiet = error only, default = info, --verbose = debug + agent output interleaving. Acceptance: --quiet suppresses info logs, --verbose shows debug. See PRD: CLI Interface.","status":"closed","priority":3,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-14T23:49:48.921881Z","created_by":"Austin King","updated_at":"2026-02-15T14:38:48.254717Z","closed_at":"2026-02-15T14:38:48.254717Z","close_reason":"Implement --quiet mode: error-only tracing + final summary line","dependencies":[{"issue_id":"simple-agent-harness-r43","depends_on_id":"simple-agent-harness-yyb","type":"blocks","created_at":"2026-02-14T23:50:56.849881Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-sxy","title":"Add SQLite dependency and create database module with improvements table","description":"Add rusqlite dependency to Cargo.toml. Create src/db.rs module with: open_or_create(path) function that opens/creates blacksmith.db in the output directory. Improvements table schema per PRD (id, ref, created, resolved, category, status, title, body, context, tags, meta). Indexes on status and category. Auto-increment ref assignment (R1, R2, ...). No CHECK constraints - validation is in CLI layer. PRD ref: Storage Model \u003e Improvements Table. Files: Cargo.toml, src/db.rs, src/main.rs (add mod db).","status":"closed","priority":1,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-15T13:27:14.461903Z","created_by":"Austin King","updated_at":"2026-02-15T13:52:03.300396Z","closed_at":"2026-02-15T13:52:03.300396Z","close_reason":"Add SQLite dependency and create database module with improvements table","dependencies":[{"issue_id":"simple-agent-harness-sxy","depends_on_id":"simple-agent-harness-ynf","type":"blocks","created_at":"2026-02-15T13:28:06.77572Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-t0t","title":"Implement JSONL event log for external tooling","description":"Optionally write harness-events.jsonl (configured via [output] event_log). Append one JSON line per significant state transition: session_complete events with fields ts, event, iteration, global, output_bytes, exit_code, duration_secs, committed, retries, rate_limited. File is append-only, one line per session. Designed for self-improvement tool ingestion. Acceptance: after N iterations, event log has N entries, each valid JSON. See PRD: Event Log section.","status":"closed","priority":2,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-14T23:48:48.41639Z","created_by":"Austin King","updated_at":"2026-02-15T01:25:32.653407Z","closed_at":"2026-02-15T01:25:32.653407Z","close_reason":"Implement JSONL event log for external tooling","dependencies":[{"issue_id":"simple-agent-harness-t0t","depends_on_id":"simple-agent-harness-p0y","type":"blocks","created_at":"2026-02-14T23:50:46.393057Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-t4x","title":"Implement integration retry loop with circuit breaker state tracking","description":"Extract the core circuit breaker mechanism: track attempt count per integration, determine retry vs trip (max 3 attempts), expose state (Retrying/Tripped) for both agent spawning and failure handling to consume. This is the shared foundation that both agent spawning (m5l) and failure handling (yg5) build on. Key file: src/integrator.rs.","status":"closed","priority":1,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-15T16:45:29.505036Z","created_by":"Austin King","updated_at":"2026-02-15T16:57:30.432988Z","closed_at":"2026-02-15T16:57:30.432988Z","close_reason":"Implement circuit breaker state tracking for integration retry loop"}
{"id":"simple-agent-harness-tzx","title":"Implement prompt_via config with arg/stdin/file delivery modes","description":"Add prompt_via config field to agent config: arg (default, existing behavior with {prompt} substitution), stdin (write prompt to agent's stdin), file (write prompt to temp file, substitute {prompt_file} in args). Implement all three modes in the session spawning code. Clean up temp files after session. Reference: SPEC-v3-agents.md lines 358-393. Key files: src/config.rs, src/session.rs, src/runner.rs.","status":"closed","priority":2,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T14:53:45.958973Z","created_by":"Austin King","updated_at":"2026-02-15T16:17:37.954253Z","closed_at":"2026-02-15T16:17:37.954253Z","close_reason":"Implement prompt_via config with arg/stdin/file delivery modes"}
{"id":"simple-agent-harness-utz","title":"Implement configuration loading and CLI argument parsing","description":"Implement config.rs and CLI parsing in main.rs. Config struct with serde derives, all fields from PRD [session], [agent], [watchdog], [retry], [backoff], [shutdown] sections. Load from harness.toml with compiled defaults for every field (so an empty file is valid). CLI flags via clap derive: --config, --prompt, --output-dir, --timeout, --retries, --dry-run, -v, -q, --status, plus positional MAX_ITERATIONS. Implement precedence: CLI flags \u003e harness.toml \u003e defaults. Acceptance: unit tests for default config, TOML loading, and CLI override merging. See PRD sections: Configuration, CLI Interface.","status":"closed","priority":1,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-14T23:48:09.799333Z","created_by":"Austin King","updated_at":"2026-02-15T00:03:47.416239Z","closed_at":"2026-02-15T00:03:47.416239Z","close_reason":"Implement config loading, CLI override merging, and unit tests","dependencies":[{"issue_id":"simple-agent-harness-utz","depends_on_id":"simple-agent-harness-ewc","type":"blocks","created_at":"2026-02-14T23:50:27.460281Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-v25","title":"Implement improve show/update/promote/dismiss/search commands","description":"Add remaining improve subcommands: show (display single improvement by ref with all fields), update (modify status/body/context by ref), promote (shorthand for --status=promoted with timestamp), dismiss (shorthand for --status=dismissed with --reason stored in meta JSON), search (full-text search across title, body, context fields). PRD ref: CLI Interface \u003e Improvement commands. Files: src/improve.rs, src/db.rs.","status":"closed","priority":2,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T13:27:17.054147Z","created_by":"Austin King","updated_at":"2026-02-15T14:15:41.45028Z","closed_at":"2026-02-15T14:15:41.45028Z","close_reason":"Implement improve show/update/promote/dismiss/search commands","dependencies":[{"issue_id":"simple-agent-harness-v25","depends_on_id":"simple-agent-harness-evl","type":"blocks","created_at":"2026-02-15T13:28:10.829801Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-v6v","title":"Implement task_manifest.toml parsing and manifest application","description":"Parse task_manifest.toml from completed worktrees. Apply manifest entries mechanically: mod declarations appended to lib.rs, re-exports appended to appropriate module, Cargo.toml deps merged into [dependencies], TypeScript barrel exports appended to index.ts. Manifest entries are commutative (order-independent, append-only). Reference: SPEC-v3-agents.md lines 511-549, 565-569. Key files: src/integrator.rs.","status":"closed","priority":1,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T14:54:59.192703Z","created_by":"Austin King","updated_at":"2026-02-15T15:52:11.570044Z","closed_at":"2026-02-15T15:52:11.570044Z","close_reason":"Implement task_manifest.toml parsing and manifest application"}
{"id":"simple-agent-harness-wck","title":"Implement blacksmith gc command","description":"Add blacksmith gc CLI subcommand for manual session cleanup. Supports --dry-run (show what would be cleaned) and --aggressive (compress all eligible, delete beyond retention). Reuses the retention and compression logic from the lifecycle implementation. Reference: SPEC-v3-agents.md lines 173-177. Key files: src/main.rs, src/storage.rs.","status":"closed","priority":2,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T14:53:54.390797Z","created_by":"Austin King","updated_at":"2026-02-15T16:20:59.215199Z","closed_at":"2026-02-15T16:20:59.215199Z","close_reason":"Implement blacksmith gc command with --dry-run and --aggressive flags","dependencies":[{"issue_id":"simple-agent-harness-wck","depends_on_id":"simple-agent-harness-503","type":"blocks","created_at":"2026-02-15T14:56:45.426463Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-wdo","title":"Implement blacksmith workers status and kill commands","description":"Add blacksmith workers status CLI subcommand showing current worker pool state: worker ID, bead ID, worktree path, status (coding/integrating/idle), elapsed time. Add blacksmith workers kill \u003cworker-id\u003e to stop a specific worker process. Reference: SPEC-v3-agents.md lines 846-847. Key files: src/main.rs, src/coordinator.rs.","status":"closed","priority":2,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T14:55:18.473553Z","created_by":"Austin King","updated_at":"2026-02-15T17:28:51.497913Z","closed_at":"2026-02-15T17:28:51.497913Z","close_reason":"Implement blacksmith workers status and kill commands","dependencies":[{"issue_id":"simple-agent-harness-wdo","depends_on_id":"simple-agent-harness-f9m","type":"blocks","created_at":"2026-02-15T14:57:04.828135Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-wi2","title":"Define AgentAdapter trait and extract Claude adapter","description":"Define the AgentAdapter trait with methods: name(), extract_builtin_metrics(), supported_metrics(), lines_for_source(). Define ExtractionSource enum (ToolCommands, Text, Raw) and AdapterError type. Extract V2's existing Claude JSONL parser (currently in src/ingest.rs) into a claude adapter implementing the trait. Claude adapter supports: turns.total, turns.narration_only, turns.parallel, turns.tool_calls, cost.input_tokens, cost.output_tokens, cost.estimate_usd, session.output_bytes, session.exit_code, session.duration_secs. Reference: SPEC-v3-agents.md lines 226-284. Key files: src/ingest.rs, new src/adapters.rs or src/adapters/ module.","status":"closed","priority":1,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T14:53:30.395668Z","created_by":"Austin King","updated_at":"2026-02-15T15:10:53.22101Z","closed_at":"2026-02-15T15:10:53.22101Z","close_reason":"Define AgentAdapter trait and extract Claude adapter"}
{"id":"simple-agent-harness-x1a","title":"Implement session compression with zstd","description":"After each session completes and is ingested, compress sessions older than compress_after iterations using zstd. Add compress_after config field (default 5). Compression happens at step 8 of the loop lifecycle (after ingestion, compress the previous session). Compressed files are named {N}.jsonl.zst. Add zstd dependency to Cargo.toml. Reference: SPEC-v3-agents.md Session Lifecycle section, lines 104-169. Key files: src/runner.rs, src/config.rs, new src/storage.rs or similar.","status":"closed","priority":2,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T14:53:35.688833Z","created_by":"Austin King","updated_at":"2026-02-15T16:06:55.75633Z","closed_at":"2026-02-15T16:06:55.75633Z","close_reason":"Implement session compression with zstd","dependencies":[{"issue_id":"simple-agent-harness-x1a","depends_on_id":"simple-agent-harness-ib1","type":"blocks","created_at":"2026-02-15T14:56:42.846827Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-xyc","title":"Fix singleton lock: fs2 missing from Cargo.toml, singleton.rs doesn't compile","description":"simple-agent-harness-ckq was closed prematurely by session 50. The singleton lock is NOT functional: fs2 crate is missing from Cargo.toml, singleton.rs has unresolved imports, and DataDir::lock() doesn't exist. Multiple blacksmith processes can still run concurrently and spawn duplicate workers. This blocks safe multi-agent parallel execution. Fix: add fs2 to Cargo.toml, fix singleton.rs compilation, wire it into coordinator startup.","status":"closed","priority":0,"issue_type":"bug","owner":"shout@ozten.com","created_at":"2026-02-16T00:24:38.821499Z","created_by":"Austin King","updated_at":"2026-02-16T00:28:05.534037Z","closed_at":"2026-02-16T00:28:05.534037Z","close_reason":"Verify singleton lock fix: fs2, singleton.rs, DataDir::lock() all functional"}
{"id":"simple-agent-harness-y74","title":"Implement opencode agent adapter","description":"Implement the opencode adapter for parsing OpenCode session output. Supported metrics: turns.total, turns.tool_calls, cost.input_tokens, cost.output_tokens (if available), session.output_bytes, session.exit_code, session.duration_secs. Reference: SPEC-v3-agents.md lines 302-310. Key files: src/adapters.rs.","status":"closed","priority":3,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T14:54:13.425637Z","created_by":"Austin King","updated_at":"2026-02-15T18:08:59.371908Z","closed_at":"2026-02-15T18:08:59.371908Z","close_reason":"Implement opencode agent adapter","dependencies":[{"issue_id":"simple-agent-harness-y74","depends_on_id":"simple-agent-harness-wi2","type":"blocks","created_at":"2026-02-15T14:56:51.042353Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-yg5","title":"Implement integration circuit breaker and failure handling","description":"When integration exceeds 3 fix iterations: update bead with failure notes, label for human review, preserve worktree for inspection (don't clean up), continue scheduling unblocked tasks (only hold tasks with overlapping affected sets). Display prominent HUMAN REVIEW NEEDED message (red/bold in terminal). Reference: SPEC-v3-agents.md lines 626-651. Key files: src/integrator.rs, src/coordinator.rs.","status":"closed","priority":1,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T14:55:18.220775Z","created_by":"Austin King","updated_at":"2026-02-15T17:01:00.961474Z","closed_at":"2026-02-15T17:01:00.961474Z","close_reason":"Implement integration circuit breaker failure handling with human review escalation","dependencies":[{"issue_id":"simple-agent-harness-yg5","depends_on_id":"simple-agent-harness-t4x","type":"blocks","created_at":"2026-02-15T16:45:36.197649Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-ynf","title":"Rename package and binary from simple-agent-harness to blacksmith","description":"Rename the entire project from simple-agent-harness to blacksmith. Changes: Cargo.toml package name and binary name. CLI struct in main.rs (command name, version string, help text). Config file loading in config.rs: try blacksmith.toml first, fall back to harness.toml for backwards compat. Status file: blacksmith.status instead of harness.status (status.rs, runner.rs). All log messages and tracing output referencing the old name. Update dry-run output in main.rs. PRD ref: Milestone 0. Files: Cargo.toml, src/main.rs, src/config.rs, src/status.rs, src/runner.rs.","status":"closed","priority":1,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-15T13:27:11.61603Z","created_by":"Austin King","updated_at":"2026-02-15T13:49:42.874459Z","closed_at":"2026-02-15T13:49:42.874459Z","close_reason":"Rename package and binary from simple-agent-harness to blacksmith"}
{"id":"simple-agent-harness-yyb","title":"Implement structured console logging with tracing","description":"Set up tracing and tracing-subscriber for structured log output. Format: [timestamp] [LEVEL] key=value pairs. Keys include: iteration, global, status, pid, watchdog, stale_secs, limit, retry, output_bytes, committed. Agent subprocess output goes to JSONL file only, not console (unless --verbose). Replace any println! calls with tracing macros. Acceptance: log output matches PRD format examples. See PRD: Console Output section.","status":"closed","priority":2,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-14T23:48:39.755099Z","created_by":"Austin King","updated_at":"2026-02-15T01:20:12.417214Z","closed_at":"2026-02-15T01:20:12.417214Z","close_reason":"Implement structured console logging with tracing","dependencies":[{"issue_id":"simple-agent-harness-yyb","depends_on_id":"simple-agent-harness-utz","type":"blocks","created_at":"2026-02-14T23:50:45.148718Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-zb5","title":"Implement blacksmith adapter info/list/test commands","description":"Add three adapter CLI subcommands: 'adapter info' shows the detected/configured adapter for the current project. 'adapter list' lists all available adapters with their supported metrics. 'adapter test \u003cfile\u003e' tries parsing a file with the configured adapter and shows extracted metrics. Reference: SPEC-v3-agents.md lines 862-866. Key files: src/main.rs, src/adapters.rs.","status":"closed","priority":3,"issue_type":"feature","owner":"shout@ozten.com","created_at":"2026-02-15T14:54:18.49158Z","created_by":"Austin King","updated_at":"2026-02-15T18:11:48.194785Z","closed_at":"2026-02-15T18:11:48.194785Z","close_reason":"Implement blacksmith adapter info/list/test CLI commands","dependencies":[{"issue_id":"simple-agent-harness-zb5","depends_on_id":"simple-agent-harness-6hk","type":"blocks","created_at":"2026-02-15T14:56:52.838383Z","created_by":"Austin King"}]}
{"id":"simple-agent-harness-zl7","title":"Add coordinator SQLite tables for multi-agent state","description":"Add coordinator tables to blacksmith.db: worker_assignments (id, worker_id, bead_id, worktree_path, status, affected_globs JSON, started_at, completed_at, failure_notes), task_file_changes (assignment_id FK, file_path, change_type), integration_log (id, assignment_id FK, merged_at, merge_commit, manifest_entries_applied JSON, cross_task_imports JSON, reconciliation_run bool), bead_metrics (bead_id PK, sessions, wall_time_secs, total_turns, total_output_tokens, integration_time_secs, completed_at). Create migration in db.rs. Reference: SPEC-v3-agents.md lines 669-713. Key files: src/db.rs.","status":"closed","priority":1,"issue_type":"task","owner":"shout@ozten.com","created_at":"2026-02-15T14:54:18.846733Z","created_by":"Austin King","updated_at":"2026-02-15T15:39:22.967699Z","closed_at":"2026-02-15T15:39:22.967699Z","close_reason":"Add coordinator SQLite tables for multi-agent state"}
